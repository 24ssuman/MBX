#include <cmath>
#include <algorithm>

#include "x2b-A1B2Z2_C-v1x.h"

////////////////////////////////////////////////////////////////////////////////

namespace {




//----------------------------------------------------------------------------//

struct variable {
    double v_exp(const double& r0, const double& k,
                 const double* xcrd, int o, int x);

    double v_coul(const double& r0, const double& k,
                  const double* xcrd, int o, int x );

    void grads(const double& gg, double* xgrd, int o, int x ) const;

    double g[3]; // diff(value, p1 - p2)
};

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

double variable::v_exp(const double& r0, const double& k,
                       const double* xcrd, int o, int x )
{
    g[0] = xcrd[o++] - xcrd[x++];
    g[1] = xcrd[o++] - xcrd[x++];
    g[2] = xcrd[o]   - xcrd[x];

    const double r = std::sqrt(g[0]*g[0] + g[1]*g[1] + g[2]*g[2]);

    const double exp1 = std::exp(k*(r0 - r));
    const double gg = - k*exp1/r;

    g[0] *= gg;
    g[1] *= gg;
    g[2] *= gg;

    return exp1;
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

double variable::v_coul(const double& r0, const double& k,
                        const double* xcrd, int o, int x)
{
    g[0] = xcrd[o++] - xcrd[x++];
    g[1] = xcrd[o++] - xcrd[x++];
    g[2] = xcrd[o]   - xcrd[x];

    const double rsq = g[0]*g[0] + g[1]*g[1] + g[2]*g[2];
    const double r = std::sqrt(rsq);

    const double exp1 = std::exp(k*(r0 - r));
    const double rinv = 1.0/r;
    const double val = exp1*rinv;

    const double gg = - (k + rinv)*val*rinv;

    g[0] *= gg;
    g[1] *= gg;
    g[2] *= gg;

    return val;
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

void variable::grads(const double& gg, double* xgrd, int o, int x) const
{
    for (int i = 0; i < 3; ++i) {
        const double d = gg*g[i];

        xgrd[o++] += d;
        xgrd[x++] -= d;
    }
}

//----------------------------------------------------------------------------//

struct monomer {
    double oh1[3];
    double oh2[3];

    void setup(const double* ohh,
               const double& in_plane_g, const double& out_of_plane_g,
               double x1[3], double x2[3]);

    void grads(const double* g1, const double* g2,
               const double& in_plane_g, const double& out_of_plane_g,
               double* grd) const;
};

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

void monomer::setup(const double* ohh,
                    const double& in_plane_g, const double& out_of_plane_g,
                    double* x1, double* x2)
{
    for (int i = 0; i < 3; ++i) {
        oh1[i] = ohh[i + 3] - ohh[i];
        oh2[i] = ohh[i + 6] - ohh[i];
    }

    const double v[3] = {
        oh1[1]*oh2[2] - oh1[2]*oh2[1],
        oh1[2]*oh2[0] - oh1[0]*oh2[2],
        oh1[0]*oh2[1] - oh1[1]*oh2[0]
    };

    for (int i = 0; i < 3; ++i) {
        const double in_plane = ohh[i] + 0.5*in_plane_g*(oh1[i] + oh2[i]);
        const double out_of_plane = out_of_plane_g*v[i];

        x1[i] = in_plane + out_of_plane;
        x2[i] = in_plane - out_of_plane;
    }
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

void monomer::grads(const double* g1, const double* g2,
                    const double& in_plane_g, const double& out_of_plane_g,
                    double* grd) const
{
    const double gm[3] = {
        g1[0] - g2[0],
        g1[1] - g2[1],
        g1[2] - g2[2]
    };

    const double t1[3] = {
        oh2[1]*gm[2] - oh2[2]*gm[1],
        oh2[2]*gm[0] - oh2[0]*gm[2],
        oh2[0]*gm[1] - oh2[1]*gm[0]
    };

    const double t2[3] = {
        oh1[1]*gm[2] - oh1[2]*gm[1],
        oh1[2]*gm[0] - oh1[0]*gm[2],
        oh1[0]*gm[1] - oh1[1]*gm[0]
    };

    for (int i = 0; i < 3; ++i) {
        const double gsum = g1[i] + g2[i];
        const double in_plane = 0.5*in_plane_g*gsum;

        const double gh1 = in_plane + out_of_plane_g*t1[i];
        const double gh2 = in_plane - out_of_plane_g*t2[i];

        grd[i + 0] += gsum - (gh1 + gh2); // O
        grd[i + 3] += gh1; // H1
        grd[i + 6] += gh2; // H2
    }
}


//----------------------------------------------------------------------------//

} // namespace

////////////////////////////////////////////////////////////////////////////////

namespace h2o_ion {

//----------------------------------------------------------------------------//

x2b_h2o_ion_v2x::x2b_h2o_ion_v2x(std::string mon1, std::string mon2) {

  // Check which pair of monomers we have and set it up accordingly
  // Fluoride
  if (mon1 == "h2o" && mon2 == "f") {
    twobodyfit = std::vector<double> {
 1.578462246457094e+02, // 0
-1.416620731039044e+03, // 1
 1.315893487301676e+03, // 2
 1.114480175412976e+01, // 3
 9.817869451719893e+00, // 4
 2.153014383381440e+02, // 5
 1.694393193651217e+03, // 6
-8.480915876843703e+00, // 7
 1.153816868961228e+02, // 8
-1.605803931264597e+03, // 9
-7.024478693132092e+01, // 10
 1.608015057189577e+01, // 11
-3.414574320588044e+02, // 12
 3.659828126280473e+00, // 13
-3.624685361027008e+02, // 14
 8.583620207620928e+02, // 15
-3.342473758371883e+02, // 16
 1.447507702473459e+02, // 17
 1.181532669606269e+01, // 18
 2.966894050181663e+02, // 19
 1.676699437195234e+02, // 20
 6.351453558574597e+01, // 21
 1.060328588758762e+01, // 22
 2.950368991202588e+00, // 23
-4.984767908681524e+01, // 24
 1.002601885447448e+01, // 25
 1.858317181960633e+02, // 26
 1.106041234213195e+03, // 27
-8.973793288015908e+02, // 28
-2.043779530795769e+02, // 29
 5.271446204947553e+00, // 30
 2.195033180029006e+01, // 31
 1.225029931947140e+00, // 32
 6.559812054346483e+01, // 33
-1.258388422460682e+03, // 34
 5.066642497647232e+02, // 35
-5.361161711581339e-01, // 36
-5.794627607906941e+01, // 37
-2.981440493946794e+02, // 38
-4.416992364538326e+02, // 39
-3.786752119161428e+02, // 40
-4.659872524468359e+00, // 41
-2.324431534965904e+00, // 42
 5.350318136201076e-02, // 43
-4.951359201531903e+02, // 44
-4.104163104804822e+01, // 45
 2.221748607364699e+01, // 46
 1.377698437229007e+01, // 47
-2.631184769291139e+01, // 48
 3.370379438447617e+00, // 49
-1.484007237233889e+01, // 50
-1.148867059278441e+01, // 51
 5.811221951915475e+01, // 52
-2.667427335112046e+02, // 53
 6.857638706619714e+02, // 54
 6.675976354944140e+02, // 55
 1.038563042210655e+01, // 56
 5.747214643375883e+02, // 57
-1.203172506969757e+02, // 58
-2.322402896602356e+02, // 59
-1.550836847629038e+00, // 60
-1.932114720054691e+02, // 61
 2.126101203471093e-02, // 62
-1.745304590105290e+00, // 63
-1.265885908953012e+01, // 64
-2.309723438360855e+01, // 65
-2.287013833167685e+01, // 66
-3.801212000991050e-01, // 67
 2.488278195895942e+02, // 68
-3.579733451660994e-04, // 69
-1.409361722824848e+01, // 70
 2.332253842155918e-02, // 71
 9.346595723829493e+00, // 72
-6.482354261555895e+02, // 73
 1.290347185607268e+00, // 74
-9.262890798708844e+01, // 75
-9.276438262203747e+00, // 76
 7.723040419751101e+00, // 77
-7.126589513351366e-01, // 78
 2.584360372694027e+01, // 79
-6.607636911031220e-04, // 80
-2.214547099670971e+02, // 81
-5.775861212568044e-03, // 82
 1.880949499889047e-03, // 83
-2.845236405768351e-03, // 84
-2.025568807041692e-05, // 85
-1.085208031459650e+02, // 86
 3.594723568294666e-01, // 87
 9.477275595434323e+02, // 88
 2.516265189879102e-01, // 89
-8.691441682223654e-01, // 90
 4.501858746187467e+01, // 91
-1.797159444735843e+00, // 92
-2.247095313123156e+01, // 93
 1.906113314633428e+01, // 94
 2.215690830248207e+02, // 95
-2.204023078377392e+00, // 96
 4.968480731114957e+00, // 97
-2.300536472642374e+02, // 98
 2.813817842022163e-01, // 99
 2.306268411791828e-02, // 100
 1.088432759785828e-03, // 101
-8.340075424565714e-01, // 102
-5.232318497182023e+01, // 103
-1.060063585410047e+01, // 104
-2.826253344679845e+00, // 105
-7.568023652920755e-02, // 106
-3.373437161945860e+02, // 107
-7.621952520631739e+01, // 108
-2.912153550743466e+00, // 109
-3.131781664049721e-01, // 110
 1.247881107710584e+00, // 111
-2.357560759745696e+00, // 112
 2.585652579193726e-04, // 113
-3.156136062064144e-02, // 114
-1.988315074948771e+02, // 115
-1.956584411448078e+01, // 116
 7.403132092602496e+01, // 117
-1.433684045321522e+00, // 118
-2.949107869047201e+00, // 119
-5.374762428886386e+00, // 120
 3.379869162793585e+01, // 121
 1.750614701086902e-01, // 122
 7.556409222657435e+01, // 123
 7.810818325147876e+02, // 124
-9.468217774694261e-01, // 125
 3.378572975824540e-01, // 126
-3.084907799755651e+02, // 127
 2.488696606067083e+01, // 128
-2.630106793304087e-02, // 129
 5.363942849543435e+01, // 130
-5.116209417265498e+02, // 131
 2.629435283482012e+00, // 132
-6.225810178961368e+00, // 133
 1.107407903316106e+01, // 134
 3.338491381328588e-01, // 135
 1.055584430133654e-02, // 136
-4.978050744954163e-02, // 137
-2.895377768981411e+01, // 138
 3.913737482888070e+02, // 139
-1.289847051643921e-02, // 140
-1.017335218238104e+01, // 141
 4.841254567011998e+01, // 142
-4.682928580512599e+02, // 143
 9.947250843171354e+00, // 144
-1.908795509608038e-01, // 145
-1.729423870969231e+01, // 146
-1.642138155310465e+00, // 147
 3.109347411351374e+02, // 148
 1.144889275845506e+01, // 149
-1.811707901271724e+01, // 150
 3.203481801637945e+00, // 151
 1.050686332034561e+02, // 152
 1.102361039313363e-01, // 153
-2.442701200325084e-02, // 154
 3.371580371287251e-01, // 155
 6.283914192264330e+02, // 156
 3.132732712080414e+00, // 157
-1.655256043348225e-02, // 158
-1.130013170249022e-02, // 159
 3.556415402807807e+00, // 160
-4.587849475460723e-05, // 161
-1.093147563103643e+00, // 162
 1.237530579939980e+01, // 163
 1.412395209493829e+01, // 164
 6.890215836737656e-01, // 165
-1.007659598455559e+02, // 166
-1.569615139942556e+00, // 167
 3.456921725388745e-01, // 168
-2.057055341877949e+00, // 169
-8.684278579980917e+00, // 170
 1.960426607934119e-03, // 171
 5.278229298977362e+00, // 172
 1.146690689840142e+00, // 173
-6.398207506979777e+00, // 174
-7.319430311028881e+01, // 175
-3.381037531062406e-01, // 176
 3.281245974936094e-02, // 177
 4.237711552808398e+00, // 178
 9.274602208123367e-02, // 179
 2.788835983604223e+00, // 180
-4.250820875543500e+02, // 181
 5.358679962976260e-01, // 182
-1.277202871343089e-03, // 183
 5.238155157637738e+02, // 184
 6.673473060708694e-05, // 185
 1.887298968615758e-04, // 186
 2.954495726447497e+01, // 187
-2.586191556734085e-04, // 188
 5.522643803617232e-02, // 189
-9.050951441299127e+00, // 190
-7.379072366263189e+02, // 191
-8.703829478427812e-02, // 192
 3.098348979404206e-01, // 193
-3.298156483123567e+00, // 194
-1.772043083409937e-03, // 195
 2.571646513241180e-02, // 196
 9.629375104208686e-03, // 197
 7.769571686259818e+01, // 198
 6.232259541493623e-02, // 199
-1.138164607056744e+00, // 200
-4.059902007440217e-03, // 201
 8.049736229964791e-02, // 202
 6.244272192883984e+00, // 203
 2.707926100350531e-01, // 204
-1.881725816351576e+00, // 205
-1.766517732173933e+01, // 206
 5.220919384245319e-04, // 207
-1.801065854357449e+02, // 208
-1.105339871163005e+01, // 209
-6.801845544093060e-05, // 210
 1.542305768971905e-01, // 211
 3.235120545954704e-05, // 212
-8.655267965464345e-03, // 213
-5.188153164352579e+00, // 214
-5.073626578089546e-02, // 215
 1.097284474683629e+00, // 216
-4.937244445329845e-01, // 217
 4.635222117704887e+00, // 218
 7.738066428094175e-04, // 219
 6.832699043145603e-04, // 220
 5.481792639128959e-02, // 221
-5.425614734001132e+00, // 222
 1.305546815444197e+00, // 223
 2.690866427624422e-02, // 224
-6.764412239566073e+01, // 225
-3.990955345328736e-05, // 226
-5.161183812621674e-08, // 227
 4.634471018736501e-04, // 228
 1.345992533500829e-02, // 229
 2.948917539480573e-01, // 230
-9.579305917027247e+00, // 231
 8.350635160829929e-01, // 232
-3.249410216467142e-05, // 233
 2.977511163040534e+01, // 234
-3.545497774144769e-02, // 235
 3.475924210494302e+00, // 236
-9.675119210323878e+00, // 237
 1.018688593542844e-01, // 238
-6.482775356725442e+01, // 239
-6.359260938797934e+00, // 240
 1.277666570123760e-01, // 241
-2.470000018112851e-03, // 242
 9.600447968307698e-01, // 243
-2.950537463644461e-06, // 244
 5.378326727571295e-04, // 245
 7.764354876333163e+00, // 246
-1.443669298679103e-04, // 247
 1.255956801653121e-03, // 248
-1.705829352911747e-03, // 249
-7.201195587872334e-04, // 250
-1.173713506435676e+00, // 251
 1.280700547366523e-01, // 252
-4.006751684292525e-02, // 253
 4.288724123980125e+01, // 254
 4.691977770113910e-02, // 255
 9.371690297151672e-03, // 256
 1.504653043275154e+01, // 257
-1.280003636875513e-02, // 258
 1.688954201337457e+02, // 259
 1.972677603479768e+02, // 260
 5.197379360544110e-01, // 261
-4.004998379322794e+00, // 262
 5.433272625348508e-02, // 263
-4.988699383450526e-01, // 264
-2.176417166755984e-02, // 265
 3.391238731791972e-04, // 266
-3.824211930888951e-01, // 267
-2.606461453940770e-01, // 268
-1.962338154126035e-02, // 269
 3.648935721781654e-03, // 270
-4.610171333444887e-01, // 271
 1.934034890493430e+02, // 272
-6.655276853416956e+00, // 273
-4.759890878022987e-01, // 274
-2.127305750224419e-02, // 275
-2.083021342703677e+00, // 276
-2.711953527064550e-04, // 277
-5.245997389256045e-01, // 278
 5.278186773690363e-03, // 279
 3.665562132684954e-05, // 280
-1.291867860328158e+01, // 281
-1.084271951699587e+00, // 282
-4.100229956411156e+00, // 283
-5.565320260677825e-04, // 284
 1.478709953679420e-01, // 285
-6.546904718068215e-02, // 286
-1.508330535494179e-02, // 287
 1.918094671156626e+00, // 288
-2.697672532517957e-05, // 289
 3.977421897192662e-04, // 290
 9.115384006247497e+00, // 291
-1.204711559665077e+01, // 292
 6.519277317706553e-01, // 293
-7.443556318792285e+01, // 294
 4.391034276427841e-01, // 295
-1.152973106683350e-01, // 296
 1.779080388818094e+00, // 297
-5.164397097046191e-03, // 298
 6.349416159204714e-01, // 299
 1.340793916584540e+00, // 300
-2.362390874893369e+00, // 301
 1.441587217845033e-07, // 302
 1.517660160954249e-01, // 303
 3.224568070013416e-04, // 304
 1.846154800830797e+00, // 305
 3.887260917398213e+01, // 306
-5.863237453289268e-07, // 307
 2.428391479759381e+00, // 308
 1.064459167858674e-07, // 309
-2.759915174924720e+01, // 310
-6.245601472357560e-01, // 311
-4.518326498624238e+00, // 312
 3.967768269591905e+01, // 313
-1.523794004317748e-01, // 314
-3.159176087654945e-01, // 315
-1.038414243607055e-05, // 316
 1.260588361709713e+01, // 317
-7.200726209426643e-06, // 318
 1.262814660626533e-03, // 319
 8.867796366645665e+00, // 320
 6.178315761832319e+00, // 321
 1.685898460146847e-03, // 322
-1.890861602591501e-02, // 323
-1.216010971305509e+02, // 324
 4.544910120586747e+00, // 325
-1.306751878731478e-01, // 326
 7.645534373133966e+00, // 327
 1.627887846121654e+00, // 328
 3.428419439320466e-03, // 329
 2.976679693741725e-03, // 330
 1.041359790626110e+01, // 331
-3.037015063999985e-02, // 332
 2.064338009850955e+00, // 333
 1.062425121456019e-01, // 334
-1.035786675421410e-06, // 335
-5.431153722277143e-03, // 336
 5.788643674595947e-06, // 337
-1.791441272179277e+01, // 338
-5.060016072153610e+00, // 339
-2.179922508130352e+00, // 340
-9.035764657826620e-04, // 341
-8.977259171041060e-02, // 342
 2.106159320331942e+00, // 343
 2.393324060797464e-02, // 344
 2.711288940935865e+01, // 345
 2.727637020772523e+00, // 346
-1.085822339836821e-03, // 347
 1.991395649430856e+00, // 348
 2.299591574898312e-03, // 349
 6.862792598705423e-01, // 350
-2.962777843109120e-01, // 351
 9.714020207158119e-01, // 352
-3.341918553803979e-01, // 353
 7.763399262448227e-06, // 354
 2.565790781891424e+02, // 355
 1.146540291895324e+00, // 356
 1.146730538509627e-05, // 357
 9.482166594194855e-01, // 358
-6.041186718253243e-02, // 359
 5.222260127690301e-02, // 360
 3.294749267793087e-02, // 361
 4.281725277913450e-04, // 362
-2.932979992553202e+01, // 363
 7.438746465625887e-01, // 364
-1.286592883058282e+01, // 365
-1.707477520912445e-03, // 366
-6.864388938604302e-03, // 367
-7.629057750544155e-02, // 368
 1.031057243843884e+00, // 369
 2.026013460088408e-05, // 370
 4.242212363300133e+02, // 371
 1.403385244116427e-02, // 372
-2.811460616749916e-05, // 373
 1.895122843896708e-01, // 374
 6.227374377563215e-01, // 375
-3.206909583446932e-01, // 376
 2.946809053665220e-03, // 377
-4.064582090978790e+00, // 378
 1.885804725384869e+01, // 379
-3.663384490777997e-04, // 380
-4.817946957415086e+00, // 381
 3.208962340222908e-05, // 382
 3.137320581289980e-05, // 383
-8.848492030836285e+02, // 384
 1.472920715505278e-03, // 385
 1.857781651385595e-04, // 386
-1.930806449008808e+02, // 387
 3.286700029821578e+00, // 388
-5.184684400869777e-02, // 389
-6.425198408930478e+01, // 390
 1.548956066360045e-02, // 391
-1.169456574083357e-01, // 392
 3.307097696644457e+00, // 393
-1.083732790486482e-05, // 394
 2.715562799542300e-03, // 395
-4.539483298954446e-01, // 396
 1.838572626137854e-02, // 397
 4.912446165000571e-01, // 398
-1.924737583217020e+00, // 399
 4.518965448823905e-01, // 400
-1.687501596808455e+01, // 401
 1.169671789837248e-06, // 402
-4.385220320267929e-02, // 403
-3.582695323718308e-01, // 404
-1.077026616731457e+00, // 405
-1.605773267687630e+00, // 406
-5.618005128622694e-04, // 407
-5.956179236983322e-01, // 408
 2.022076931618516e-03, // 409
 2.050295030915751e+01, // 410
-4.350477299376168e+00, // 411
-6.041222387774281e-02, // 412
 1.622815230502720e+02, // 413
 1.578054708328266e+01, // 414
-3.567688150906675e-01, // 415
-3.184364521602483e-04, // 416
-1.907611434967482e-01, // 417
-3.137527837221146e-01, // 418
 1.426523958312090e-02, // 419
-1.154236600744906e-02, // 420
 8.571160119746683e-03, // 421
 7.712847005999159e-02, // 422
-1.067207657009140e-04, // 423
-7.264098718055696e-02, // 424
 2.002148921746518e-03, // 425
 8.928737222180260e-01, // 426
 3.967003108681723e-02, // 427
 3.695421855443182e-03}; // 428
    k_HH_intra =  2.194623068945859e-01; // A^(-1)
    k_OH_intra =  3.060774119116303e-01; // A^(-1)
    k_XH_coul =  8.284743593018360e-01; // A^(-1)
    k_XO_coul =  8.550494472689398e-01; // A^(-1)
    k_xlp_main =  1.008493192013656e+00; // A^(-1)
    d_HH_intra =  1.067370468009889e+00; // A^(-1)
    d_OH_intra =  1.548024667376308e+00; // A^(-1)
    d_XH_coul =  6.247582187500333e+00; // A^(-1)
    d_XO_coul =  6.991282760029556e+00; // A^(-1)
    d_xlp_main =  4.173878769344205e+00; // A^(-1)
    in_plane_gamma = -9.721486914088159e-02;
    out_of_plane_gamma =  9.859272078406150e-02;
    r2i =  5.000000000000000e+00; // A
    r2f =  6.000000000000000e+00; // A
  }

  // Chloride
  if (mon1 == "h2o" && mon2 == "cl") {
    twobodyfit = std::vector<double> {
 1.992108786573811e+02, // 0
-8.387140200659405e+02, // 1
 5.650911147610440e+02, // 2
 2.210430376165250e+02, // 3
 1.023753259139149e+02, // 4
-1.707001283939466e+02, // 5
 9.616875529693134e+02, // 6
-4.067920555659061e+01, // 7
-9.728712665539273e+01, // 8
-5.876697632787894e+02, // 9
 2.822982006701083e+01, // 10
-8.455626839471037e+00, // 11
 1.655078312096410e+02, // 12
-2.682274077135988e+02, // 13
-3.682015483969096e+02, // 14
 1.505774698471652e+02, // 15
-6.431191797661384e+02, // 16
 2.996367112690382e+02, // 17
 1.501260784365025e+02, // 18
-8.082285657445527e+01, // 19
 4.398176714995435e+02, // 20
 7.055660127816824e+01, // 21
-3.380495745217909e+00, // 22
-4.052349001579732e+00, // 23
-6.693603597825734e+01, // 24
 4.312433727166905e+02, // 25
 1.032002427808121e+02, // 26
 6.820313713682332e+02, // 27
 1.575949245738103e+02, // 28
-4.490775154845709e+02, // 29
 1.270224014348218e+01, // 30
-3.015944391573645e+01, // 31
 2.496181469291794e+00, // 32
 2.826253481677410e+02, // 33
-1.090940623589324e+03, // 34
-4.888244012162375e-01, // 35
-1.982812600077667e+00, // 36
-3.752252264705805e+02, // 37
-1.832277630203675e+02, // 38
-3.087734160760047e+01, // 39
 6.982033349529225e+01, // 40
-9.165614783663105e+01, // 41
 2.138669432972345e+01, // 42
 7.845116227408061e-01, // 43
-9.689327665950216e+01, // 44
-1.172757183385094e+02, // 45
-1.038240083940447e+01, // 46
 5.789167407143877e+01, // 47
-7.193600313906968e+01, // 48
 2.004743619138773e+01, // 49
 4.813548752161346e+01, // 50
 8.016951704564276e+00, // 51
-3.151886626575719e+01, // 52
 4.475844051048532e+02, // 53
-9.253353785272630e+01, // 54
 8.437651973662705e+01, // 55
-5.315193824704026e+01, // 56
 4.140985830249481e+02, // 57
-1.457208941003579e+02, // 58
-3.304785499729539e+02, // 59
-2.217274639114340e+01, // 60
-4.404366490891006e+01, // 61
 4.779399778462704e-01, // 62
 4.909854021287986e+00, // 63
-1.819619725690086e+01, // 64
-3.649961734963189e+01, // 65
 7.912339212185572e+01, // 66
-4.199710703919823e+01, // 67
-1.023212320111632e+02, // 68
 5.507157923978376e-02, // 69
 2.088815691032360e+01, // 70
 7.499733234829035e-02, // 71
 5.608982779333522e+00, // 72
-4.519336434847721e+02, // 73
 3.967975280148758e+01, // 74
-3.247833962769786e+02, // 75
 1.726301053743612e-01, // 76
-2.098937161941697e+01, // 77
-3.478765375219643e+00, // 78
 1.737950110095734e+02, // 79
 2.818264925964444e-01, // 80
-1.628640177792254e+02, // 81
 1.404686620040778e-01, // 82
 1.681350608631806e-01, // 83
 1.189774316079702e-01, // 84
-1.677386847642121e-03, // 85
 3.319876301409049e+02, // 86
 1.460635957015530e+01, // 87
 5.081188951535335e+02, // 88
 4.356946987208854e+00, // 89
-3.485708533031390e+01, // 90
-2.538033973182466e+01, // 91
-1.231067028371468e+01, // 92
-8.379546229976773e+01, // 93
 6.956407711842870e+01, // 94
 2.027888764478208e+02, // 95
 3.047250217252204e+01, // 96
-1.172979709064035e+02, // 97
-2.727889005752234e+01, // 98
-1.669580048032266e+02, // 99
-1.380227566557266e+01, // 100
-1.243534567442378e-01, // 101
-3.948169338276006e+00, // 102
 9.369680953754404e+00, // 103
-1.042089447452037e+02, // 104
-2.496734659615336e+01, // 105
-4.110559886993196e+00, // 106
-1.515519606985727e+02, // 107
-1.568526660773612e+02, // 108
 9.396757919354740e-01, // 109
 6.203227720733110e-02, // 110
 1.287430508192387e+01, // 111
-4.545943661987693e+00, // 112
-6.152301231278598e-02, // 113
-6.705247599974183e-01, // 114
 1.456876478060916e+01, // 115
-1.369159388603182e+01, // 116
 1.392464464315393e+02, // 117
-1.254923729024396e+01, // 118
-6.948066813445324e+00, // 119
-7.508867479022525e-01, // 120
 1.128468408320972e+01, // 121
-1.104156466737599e+00, // 122
 1.258272469094693e+01, // 123
 3.278750300027691e+01, // 124
-6.158985586497290e-01, // 125
-3.238328617833168e-01, // 126
-4.420533473546186e+02, // 127
-2.495441567839318e+01, // 128
-4.416733028253601e-01, // 129
 9.446448265407694e-01, // 130
-2.317438307661459e+02, // 131
 1.310382828948102e+01, // 132
-2.041682989959099e+01, // 133
 1.040966548216596e+01, // 134
 2.090660238865800e+01, // 135
 1.553841293909935e-01, // 136
-6.711770791319777e-01, // 137
-1.479717616609379e+02, // 138
 5.474552324781542e+02, // 139
-2.677402737059923e-01, // 140
-3.075691923538171e+00, // 141
 9.262855995858392e+01, // 142
-2.319746536542513e+02, // 143
 1.363272736123546e+02, // 144
 1.287042863339547e+00, // 145
-4.867736527588360e+00, // 146
-4.814360275438727e+00, // 147
 1.838655178550437e+02, // 148
 2.701343393719806e+01, // 149
-5.982009267749206e+00, // 150
 1.819504496209612e-01, // 151
 1.974007443021220e+01, // 152
 5.042873636739682e-01, // 153
 3.086930279751438e-01, // 154
 4.837459571000391e-01, // 155
-4.244761624457736e+02, // 156
-9.527839783906498e-01, // 157
-2.457980947025955e-01, // 158
-4.575581534011258e-01, // 159
-2.674012582166435e+00, // 160
 1.227946681602511e-02, // 161
 1.039266748391725e+01, // 162
 5.022614459154438e+01, // 163
 1.101392281088369e+02, // 164
 4.074239688586977e+00, // 165
 2.127294484449519e+02, // 166
 3.195692581602386e+00, // 167
 3.745759363561620e+00, // 168
-2.133424492267757e+01, // 169
-1.445833885988621e+01, // 170
-1.954473755460321e-01, // 171
-1.107873013912396e+02, // 172
 2.685081655778733e+01, // 173
 4.274415171115231e-01, // 174
-5.130485784703308e+01, // 175
-1.326050414520033e+00, // 176
 2.791648588554395e-01, // 177
 4.797149012171806e+01, // 178
-3.408988530795003e-02, // 179
-7.548508730955700e+00, // 180
 2.153902918911432e+02, // 181
 1.562610161081835e+00, // 182
-4.095495731931535e-01, // 183
 2.013713903635507e+02, // 184
 1.163060670996253e-02, // 185
 1.160124863023216e-02, // 186
 1.333335427495307e+02, // 187
 3.276400713871803e-02, // 188
 1.171201499938104e-01, // 189
 3.015110714491404e+01, // 190
-6.349902433738775e+02, // 191
-1.895566135135278e-01, // 192
-4.568305204235387e-01, // 193
-2.775409761592227e+01, // 194
 4.990689245316944e-02, // 195
 6.079062458446800e-02, // 196
-1.393224061285059e-01, // 197
-1.230537849236875e+02, // 198
-5.747342969229818e-02, // 199
-1.061355507775773e+01, // 200
-1.975458901359205e-01, // 201
 3.970201947917035e-01, // 202
-1.004955845541275e+00, // 203
 2.385329188432487e+00, // 204
-4.577688291854154e+00, // 205
-1.018434636603219e+02, // 206
-3.037830047058708e-02, // 207
 7.683719477746911e+01, // 208
-7.004723457577224e+01, // 209
 3.479822572390345e-03, // 210
 2.531359729005783e-01, // 211
-5.842755256292480e-03, // 212
 2.351182308913856e-01, // 213
 1.058261404642678e+00, // 214
-4.106132043209183e-02, // 215
 4.494564879098585e+00, // 216
-1.128676840069381e+01, // 217
-2.144538265984925e+00, // 218
 8.839376965594528e-02, // 219
 9.399705419947775e-02, // 220
-5.883710423723117e-01, // 221
-4.196671390468032e+01, // 222
-1.755146869021969e-02, // 223
 2.690973708055738e-01, // 224
-7.019415814440492e+00, // 225
-2.326485915537783e-02, // 226
 3.209324945467276e-05, // 227
-6.912479238708394e-02, // 228
 1.694937782296061e-01, // 229
 1.630928098108120e+00, // 230
-2.721703341259396e+01, // 231
 2.754382962281634e+00, // 232
-1.873269969133561e-04, // 233
 7.673656758935905e+01, // 234
-1.500762591236849e-01, // 235
 3.448116346260020e+01, // 236
 1.169150375775676e+00, // 237
 9.179889594302356e-01, // 238
-1.898064370646408e+01, // 239
-8.834673075817410e+00, // 240
-3.055015410357717e-01, // 241
 1.730925135849031e-02, // 242
 7.041493247350796e+00, // 243
-2.031950775749290e-04, // 244
-1.079076665469171e-02, // 245
-1.801772406649374e+00, // 246
 3.286241953669414e-02, // 247
-2.097612712843831e-01, // 248
 1.332518763067695e-02, // 249
 2.348653167946516e-02, // 250
-2.731210510532546e-01, // 251
 7.956633118616279e-01, // 252
-7.415134483170923e-01, // 253
 8.332357804129182e+01, // 254
-8.740273796896521e-03, // 255
 3.109715267033570e-01, // 256
 2.919198416493838e+00, // 257
-8.404312642545626e-02, // 258
 1.063835242771247e+02, // 259
 2.754756237817656e+02, // 260
 1.235256664732201e+00, // 261
 4.184133714420390e+00, // 262
 3.532524356315820e-01, // 263
-8.674817934104133e-02, // 264
-1.082215911195564e+00, // 265
 2.939755488080212e-03, // 266
-2.971364039803098e+00, // 267
 1.636341705709205e+00, // 268
-8.316703640607860e-02, // 269
 2.978040807584450e+00, // 270
-2.943440277954300e-01, // 271
 6.466021477051444e+01, // 272
 1.759241989960127e+00, // 273
 1.169940370830013e+00, // 274
-1.343166046878603e-01, // 275
 9.856777559263509e+00, // 276
-1.601940942860534e-02, // 277
-6.402929818967178e+00, // 278
 3.998775398234826e-01, // 279
 1.581045569047908e-03, // 280
-2.732947475100088e+01, // 281
-8.189929595684722e+00, // 282
-2.281113575334330e+00, // 283
-3.081142240693117e-01, // 284
 5.174806798031407e-02, // 285
-2.538734008990298e-01, // 286
-1.990929164833413e-01, // 287
-4.477275260602680e+00, // 288
-4.962735095443417e-03, // 289
-2.645690345817086e-02, // 290
-3.832334951683879e+00, // 291
-2.631960848192148e+01, // 292
 1.571530564454805e-01, // 293
-1.281415072923965e+02, // 294
 7.971497975906297e+00, // 295
-1.559514903150930e+00, // 296
 8.806056930345083e+01, // 297
-1.619396528827405e-01, // 298
-1.562402481163689e+00, // 299
-8.241376848978598e-01, // 300
 7.110074256724020e+00, // 301
 5.417622666220169e-05, // 302
-9.147243832054929e+00, // 303
-5.512702843924840e-02, // 304
-9.890305744654099e-01, // 305
 3.644064746250175e+01, // 306
-4.708386430679298e-04, // 307
 1.845319125360156e+00, // 308
 1.456942960090271e-04, // 309
-8.799666337642600e+00, // 310
-5.637101190140557e-02, // 311
 3.917085761813095e+00, // 312
 5.788870028286691e+01, // 313
-1.130010527450897e-01, // 314
-6.206673127760784e-02, // 315
-1.252661132773504e-02, // 316
 2.669824699465675e+01, // 317
 1.014372645411418e-03, // 318
-7.963570349179191e-02, // 319
 2.766070504432400e+00, // 320
 4.743722083564653e+00, // 321
 6.616481316175990e-02, // 322
-1.740696293096981e-02, // 323
-1.351607740881771e+02, // 324
-2.174849133346797e+00, // 325
-2.270004510011741e-01, // 326
-4.497160340007917e+01, // 327
-3.400594292716579e+01, // 328
-8.871787795841806e-03, // 329
 5.693816474333713e-02, // 330
 2.731879774916651e-02, // 331
-2.609855127428903e+00, // 332
-1.906833107770516e+00, // 333
 2.884249729642408e+00, // 334
 4.471001940329830e-04, // 335
-3.239994690682912e-02, // 336
-2.543757502660508e-03, // 337
-3.327112490160030e-01, // 338
 4.425256733578492e+00, // 339
 2.189612194506381e+00, // 340
-5.032540588985768e-03, // 341
 3.703942161259542e-01, // 342
 5.655008211280064e+00, // 343
 3.518331416551533e-01, // 344
 4.338479220679372e+00, // 345
 2.672971671604099e+01, // 346
-8.219137817805970e-02, // 347
-6.486156314962371e+01, // 348
-5.869677270886713e-02, // 349
-2.096563223068471e+00, // 350
 1.132854999821852e+00, // 351
-1.436596857917909e+00, // 352
-9.670759632199189e+00, // 353
 8.648934568511580e-05, // 354
 9.053759320874798e+01, // 355
 6.028963689350185e+00, // 356
-4.495382440743555e-04, // 357
 9.630581320451046e+00, // 358
-4.037778717112451e-02, // 359
 5.910578573857273e+00, // 360
-4.617340208004820e-01, // 361
 1.044262582572909e-01, // 362
-3.232268813368830e+01, // 363
 1.615507892098708e+01, // 364
-8.686332407452031e+00, // 365
-1.199261049211493e-01, // 366
-2.815469103339357e-01, // 367
-1.306164475539778e+00, // 368
-1.832116102385827e+00, // 369
 1.156710591456594e-02, // 370
 9.477529034357518e+02, // 371
 1.449043402011043e-01, // 372
 4.749357649505744e-04, // 373
 8.598245339644052e-01, // 374
 7.268821794946299e+00, // 375
-2.464410221307105e+00, // 376
 1.098924402957659e-01, // 377
 2.056940080618140e+01, // 378
 3.512339317924763e+01, // 379
 1.543689023186348e-01, // 380
 2.222960883759192e+00, // 381
 1.056351639973198e-03, // 382
 2.673592819450938e-03, // 383
-3.244207103448585e+02, // 384
-4.996994572852771e-02, // 385
 3.382602326928903e-02, // 386
-3.666162626965650e+02, // 387
 4.402234433237152e-01, // 388
-3.587087424075692e-01, // 389
-5.750463317757372e+01, // 390
 1.710025543284481e-01, // 391
-2.672166493011895e+00, // 392
-1.402224528495488e+00, // 393
-2.397148679427193e-03, // 394
 1.440761192090954e-01, // 395
-3.694977976171304e+00, // 396
 2.646942747341094e-01, // 397
-4.329616583638918e-02, // 398
-9.146785371660204e-01, // 399
 5.291143820188342e-01, // 400
-2.572741287727650e+01, // 401
 4.410139348371374e-04, // 402
-1.402510022992882e-01, // 403
-3.303378522115991e-02, // 404
 3.555658622256792e-01, // 405
-1.048926999941242e+00, // 406
 6.573253011961640e-02, // 407
-1.385048317927622e+01, // 408
-5.872850106996149e-03, // 409
 7.815032040192816e+00, // 410
-6.171937263040822e+01, // 411
-1.075104282221178e-02, // 412
 8.932005732106241e+01, // 413
 7.415107856622016e+01, // 414
-2.086778248248712e-01, // 415
-5.679342010585588e-02, // 416
-4.031663688201457e+00, // 417
 4.895380932724607e+00, // 418
 6.128296119349805e-01, // 419
 2.733352545172873e-01, // 420
 6.257091025339957e-01, // 421
 1.337963458287758e-01, // 422
-4.524436713275118e-03, // 423
 4.300023511596629e-01, // 424
 2.124413969098847e-02, // 425
 2.199344432023815e-01, // 426
 1.194344098953613e+00, // 427
 6.660281753348003e-02}; // 428
    k_HH_intra =  1.937475858379097e-01; // A^(-1)
    k_OH_intra =  2.470886477967268e-01; // A^(-1)
    k_XH_coul =  6.014958217038713e-01; // A^(-1)
    k_XO_coul =  9.479736651996044e-01; // A^(-1)
    k_xlp_main =  1.219299589766097e+00; // A^(-1)
    d_HH_intra =  1.999999878598716e+00; // A^(-1)
    d_OH_intra =  1.999999346810650e+00; // A^(-1)
    d_XH_coul =  6.738395678844217e+00; // A^(-1)
    d_XO_coul =  6.617349018610607e+00; // A^(-1)
    d_xlp_main =  4.516776017962630e+00; // A^(-1)
    in_plane_gamma = -9.721486914088159e-02;
    out_of_plane_gamma =  9.859272078406150e-02;
    r2i =  5.500000000000000e+00; // A
    r2f =  6.500000000000000e+00; // A
  }

  // Bromide
  if (mon1 == "h2o" && mon2 == "br") {
    twobodyfit = std::vector<double> {
 1.980059421531693e+01, // 0
-1.335498419822311e+02, // 1
 1.847637929920124e+01, // 2
 9.220543731123132e+01, // 3
 7.302451283841117e+01, // 4
-1.067343350815857e+02, // 5
 5.583463850614897e+02, // 6
-4.304961166367229e+02, // 7
 1.957164649046066e+02, // 8
-3.558631282396130e+00, // 9
-5.984645803463384e+01, // 10
 1.932724162273972e+02, // 11
 2.016014594068888e+02, // 12
-7.602920083244154e+02, // 13
-3.911710592236085e+02, // 14
-1.797777647329929e+02, // 15
-4.886341248587692e+02, // 16
 2.346145236913489e+02, // 17
 8.054512180323455e+02, // 18
 9.878788272531996e+01, // 19
 2.976617083089569e+02, // 20
 1.147959751176199e+02, // 21
 1.403757893061886e+01, // 22
 2.722076393783170e+01, // 23
-2.139487357130525e+02, // 24
 1.011293413943580e+03, // 25
 7.276637546573882e+01, // 26
-3.472801632183696e+01, // 27
 1.968022066536098e+02, // 28
-8.783359645181351e+01, // 29
-4.763689976543444e+01, // 30
-2.199875139241119e+00, // 31
 9.628939891065446e+00, // 32
 2.432428777733653e+02, // 33
-6.597383894734662e+02, // 34
 2.257709537175536e+01, // 35
-2.247901292960740e+01, // 36
-1.748532190919984e+02, // 37
 7.511483607230767e+01, // 38
-2.078200833671894e+02, // 39
 7.685529563490256e+01, // 40
 1.017881275775760e+00, // 41
-7.350681602831406e-01, // 42
-1.869940528178316e+01, // 43
-1.507307818653975e+02, // 44
-8.338613974790901e+01, // 45
-7.263120518970372e+00, // 46
 9.136332905233170e+02, // 47
-7.556039321825431e+02, // 48
 5.963532269756106e+01, // 49
-1.034377060972858e+01, // 50
-1.945590306335095e+01, // 51
 1.181565046437024e+02, // 52
 7.884947925544004e+01, // 53
-1.045411331797217e+02, // 54
-1.273309326460350e+02, // 55
 7.861691685841791e-01, // 56
 1.053033323908384e+02, // 57
-2.240836072719207e+02, // 58
-1.956457045702422e+02, // 59
-9.642612203845819e+01, // 60
-1.037778701445948e+01, // 61
 7.267425717297104e+00, // 62
-7.654256198034189e+01, // 63
 2.808183632924786e+00, // 64
-4.837957190017528e+02, // 65
 1.695433992280225e+01, // 66
 1.735293303245865e+00, // 67
-4.338922157888211e+01, // 68
 1.621707467402586e+00, // 69
-4.411721985569323e-01, // 70
 8.131548818857900e-02, // 71
 1.797439491487942e+01, // 72
-8.907663331601800e+01, // 73
 9.369170187189007e+01, // 74
-8.813489245432478e+01, // 75
-1.061469300996965e+01, // 76
 1.521451183930107e+02, // 77
-2.987409893769933e+02, // 78
 2.107913772036339e+02, // 79
-3.949268495252012e+00, // 80
-3.142399678690226e+00, // 81
 2.863472435954939e+01, // 82
-3.723518282468374e-02, // 83
-1.513477475902004e+00, // 84
-1.873029036510124e+00, // 85
 7.473604874259247e+01, // 86
 4.866902536809487e+01, // 87
 1.712395775593357e+02, // 88
 1.267737627072832e+01, // 89
-4.352888658015883e+00, // 90
-1.092424338821057e+01, // 91
 1.983700854734736e+00, // 92
-4.138791553526112e+02, // 93
 5.603778204770716e+01, // 94
 9.675715943922256e+01, // 95
 1.396091714295578e+01, // 96
-8.808370190158391e+01, // 97
 9.601737319680516e-01, // 98
-4.354458932868860e+02, // 99
 2.072674365733874e+01, // 100
 1.365778789404558e+00, // 101
-1.143353719267456e+01, // 102
 1.531435938850802e+00, // 103
-3.775681574335045e+02, // 104
-6.495121878809964e+01, // 105
 2.073468784037226e+01, // 106
-5.972378603433835e+01, // 107
-6.818219795832036e+01, // 108
 6.760450580016310e+01, // 109
 3.251707633772684e-01, // 110
-1.348653418015042e+00, // 111
-2.301998954301339e+01, // 112
-2.726038488905109e+00, // 113
-1.746651889889902e+01, // 114
-8.381424914831847e+01, // 115
 3.736948852497962e-01, // 116
 4.873500466857298e+01, // 117
-4.341947853861146e+01, // 118
-1.833309860967315e+01, // 119
-6.165335864657094e-01, // 120
 7.804862189630535e+00, // 121
 8.527857178054191e-02, // 122
-2.853355859609290e+00, // 123
-9.656305333879341e+01, // 124
 1.186509180883746e-01, // 125
-1.364383277851844e-01, // 126
-1.377334067851904e+02, // 127
 6.547456213311180e+00, // 128
-1.895291031533184e+02, // 129
 1.753842344397056e+02, // 130
 2.199928984450503e+01, // 131
-1.784005338761391e+00, // 132
-4.652047912100946e+02, // 133
 1.430633479894355e+01, // 134
 2.438456681714269e+00, // 135
-3.142553089069667e-01, // 136
 1.102996989526857e+02, // 137
-2.833112445022263e+02, // 138
 7.010110156893987e+01, // 139
 4.199954512245218e-01, // 140
-7.308011923524858e+00, // 141
-3.531278989244809e+01, // 142
-8.818422068412629e+01, // 143
 8.584828694433077e+01, // 144
-2.136135204985244e-01, // 145
 3.644341539938940e-01, // 146
-1.107023640970981e+01, // 147
 3.202655766868452e+02, // 148
-2.552279018102712e+00, // 149
-3.530050871787222e+00, // 150
 3.250206029998530e-02, // 151
 3.967383157509303e-01, // 152
-1.994407229490107e-01, // 153
-5.201446916571689e-02, // 154
 1.075000969116850e-01, // 155
 1.732308308154709e+02, // 156
 2.059510033538488e+02, // 157
 1.141834421828348e-01, // 158
 8.375690839693362e+01, // 159
-3.118020394649576e-02, // 160
 1.954904938426249e+00, // 161
 1.717126336344230e+02, // 162
 3.010090115583989e+02, // 163
-4.473372091961258e+01, // 164
 5.606038068243684e+00, // 165
-8.800591623849033e+01, // 166
 1.668794083839759e-01, // 167
-2.768209869418800e+00, // 168
-3.834318155944404e+02, // 169
 6.165549077470199e+00, // 170
-4.323465802460606e+01, // 171
 4.246603969903940e+02, // 172
 5.831451134103917e+01, // 173
-1.693907443769479e-01, // 174
 9.335053593260674e-01, // 175
-3.802408284294820e-01, // 176
-5.439292687608318e-01, // 177
-4.849861438335725e+01, // 178
 1.699271879091120e-01, // 179
 1.216999655412023e+00, // 180
 2.072658033116701e+02, // 181
 2.346060684866349e-01, // 182
 2.506704906845009e+00, // 183
 1.546063049997708e+02, // 184
-1.418480178091446e+00, // 185
 4.553120712464626e-03, // 186
 1.342137497049742e+02, // 187
-2.064239881279332e-01, // 188
-7.209118756605127e-03, // 189
 9.621452620056742e+00, // 190
-6.379848372616468e+01, // 191
 2.785868746731064e-01, // 192
 4.106510985055601e-02, // 193
-1.854705281345932e+02, // 194
-2.808456003780750e+01, // 195
 5.067000622901705e-03, // 196
 3.165963412429242e+01, // 197
 4.499026168546438e+01, // 198
 1.106257959015740e-01, // 199
-8.433395726947190e+01, // 200
-3.105822680910005e-01, // 201
-3.051802514267071e-01, // 202
 5.901999845632899e-02, // 203
 5.944547254638071e+00, // 204
 5.441059049261467e+00, // 205
-2.160400540795592e+02, // 206
-7.935965681722600e-03, // 207
 5.582965694742883e+01, // 208
-3.184691401940586e+01, // 209
 2.177832710560740e-02, // 210
-9.648665397326096e-03, // 211
 9.782827010332256e-01, // 212
-3.563632463739964e-01, // 213
-2.075692838196640e+00, // 214
 2.696542159198379e-04, // 215
 4.561050599928094e+00, // 216
-4.346362779096489e+01, // 217
 2.348112037947100e-01, // 218
-3.284669871457272e-01, // 219
 5.831789141446134e-01, // 220
 3.848011856241563e-01, // 221
 2.926366568137216e+00, // 222
 4.322736867560500e+00, // 223
-8.110660259174611e-01, // 224
 1.806870002016827e+02, // 225
 1.152956320892057e-02, // 226
 2.827658269363072e-02, // 227
 1.900845780199303e-01, // 228
-6.623697347780103e-02, // 229
 2.807406282154622e+00, // 230
 1.935146087764766e+01, // 231
 9.607566419457472e+00, // 232
-2.226629111285688e-02, // 233
 2.580281390096265e+01, // 234
-1.018013744715790e-01, // 235
-3.711964516350474e-01, // 236
-1.741554720391442e-02, // 237
 1.028299754896591e+01, // 238
 2.406437461121485e+00, // 239
-1.286787845722923e+01, // 240
-1.646822976955974e-01, // 241
 8.941552762308791e-03, // 242
 6.994799185475577e+00, // 243
-2.369266195814206e-03, // 244
-1.360801421901297e-02, // 245
 2.424725131465122e-01, // 246
 3.205721069036435e-01, // 247
-2.105484459064627e+01, // 248
-5.344261608412906e-03, // 249
 4.067528910873541e-03, // 250
-1.152673310315664e-02, // 251
 6.052207077961856e-01, // 252
 7.730883441100590e+00, // 253
 7.286102246042051e+01, // 254
 5.350208382710735e-02, // 255
 1.353697349462219e+00, // 256
 8.169826176472807e+00, // 257
-3.071127297826783e-03, // 258
 2.819175803557217e+01, // 259
 5.746224067047675e+01, // 260
 5.088429858289650e+00, // 261
-2.996273314298618e-01, // 262
 5.128244775877389e-02, // 263
 2.445218879463541e-02, // 264
-2.055433227608843e+01, // 265
 5.507578896602160e-01, // 266
-1.690626773811515e+01, // 267
-1.022464440754965e-01, // 268
 2.375919872680917e-03, // 269
 1.325681005505889e+01, // 270
 5.981428939119415e-03, // 271
-3.493760594495422e+00, // 272
-1.072310281547183e-02, // 273
-2.828825250472447e-02, // 274
 1.167133560616738e-02, // 275
-1.172494314778376e+02, // 276
-1.704322623052994e-03, // 277
-3.379100523560781e+01, // 278
 7.683467937692585e+01, // 279
 2.893269404077742e+00, // 280
 8.510379270160226e+01, // 281
-1.807094441906752e+01, // 282
-3.405687643753511e+00, // 283
-2.957316684659342e-01, // 284
 2.101984158581279e-03, // 285
 2.173847154011593e+00, // 286
 3.142742351454616e-01, // 287
 7.101420765702669e-02, // 288
-1.790586474755296e+00, // 289
-6.097423621144401e-02, // 290
 1.023797228866959e-01, // 291
-1.610066666308936e+00, // 292
-3.616992293705847e-03, // 293
-5.370536580664615e+01, // 294
 4.346480073706008e+00, // 295
 3.574000607525206e+00, // 296
 8.388430721081228e+01, // 297
 6.803543530741865e-01, // 298
 1.717291461857037e-01, // 299
 1.235891664007598e+00, // 300
-8.168157606182805e+01, // 301
-1.654755245387035e-04, // 302
-6.226175580810562e+00, // 303
 2.708221284116472e-01, // 304
-3.731319128325307e+00, // 305
-9.707403241548553e+00, // 306
 3.942962048419984e-02, // 307
 2.750950071587226e+02, // 308
-1.961880024960117e-02, // 309
 2.797694438950586e+00, // 310
 7.677053625360525e-05, // 311
-2.490602947779096e-02, // 312
-8.038288926433392e+00, // 313
-2.479578955452606e-03, // 314
 6.485109623460472e-02, // 315
-1.967989897663437e+00, // 316
-3.629778948089279e-01, // 317
 8.881126487231763e-01, // 318
 1.202412326547582e+00, // 319
-5.892858466939290e-01, // 320
 3.848733102705656e-01, // 321
 7.449553896856018e-01, // 322
-2.152432875114137e-03, // 323
-2.093736059426137e+01, // 324
 1.175091622821439e+00, // 325
-2.923603359174393e-01, // 326
 2.067783923764265e+00, // 327
-3.237896660909327e+01, // 328
 5.009593229529358e-04, // 329
 7.803506103817403e-05, // 330
 1.008636223821969e+00, // 331
-9.938817448949179e+00, // 332
-7.744790918766838e-02, // 333
 2.044040959211102e+01, // 334
-1.142184393785743e-01, // 335
 1.428344900522842e-01, // 336
-3.183736114447971e-02, // 337
-9.453047677304173e-01, // 338
-2.586595858473860e+00, // 339
-2.317580481736019e-02, // 340
-6.302695765587535e-01, // 341
-2.023941437405230e-01, // 342
-9.313201072806313e-01, // 343
 2.646042364033770e-01, // 344
-4.609438712713012e-01, // 345
-2.475947404306181e+00, // 346
-9.534463262729058e-02, // 347
 5.183965030867636e+00, // 348
 5.963187428459596e-03, // 349
 7.148089834718338e-02, // 350
-2.019590340524677e-01, // 351
 2.559995149346920e+00, // 352
 2.191108135258058e+00, // 353
 5.709165043940408e-03, // 354
 5.284279757492509e+01, // 355
 1.865661601504362e+01, // 356
 1.050460676301363e-01, // 357
 1.946339111696552e+01, // 358
 2.494730560687518e-03, // 359
 7.354798695508933e+00, // 360
 7.856061753684589e-02, // 361
-1.271383443726341e+01, // 362
 1.310539590097947e-01, // 363
-2.447471152545285e+00, // 364
 5.529698821539287e-01, // 365
-1.130206624302438e-01, // 366
-3.654357888330041e+01, // 367
 2.776160956659139e+00, // 368
 3.989671708848009e+00, // 369
-8.510403875762943e-03, // 370
 7.321424125443300e+02, // 371
-2.400201418027549e-01, // 372
-5.822211551240140e-02, // 373
-1.807320542208281e+00, // 374
 5.554699578588745e+00, // 375
-1.164552317328342e+01, // 376
 3.987483315777185e+01, // 377
-2.497467991795655e-01, // 378
-1.191151353388779e+00, // 379
 3.436186835818029e-01, // 380
-4.488508068951773e+00, // 381
 6.116515500107889e-01, // 382
 4.392265299936516e-02, // 383
-1.716464811313613e+02, // 384
 3.630124289536317e+01, // 385
 8.788570199314592e-02, // 386
-4.300245568791327e+02, // 387
-1.400751395722789e+00, // 388
 2.050651903136763e-01, // 389
-8.174797695327864e+01, // 390
-3.633423184845060e+01, // 391
-7.970644156994799e+00, // 392
-2.368155432904140e-02, // 393
-4.447630928480837e-02, // 394
 2.370718879278548e-02, // 395
-1.860575636610765e+00, // 396
 2.496179729591361e-01, // 397
-3.171768674166855e-01, // 398
-2.830994790127602e+00, // 399
-1.362958562960494e-01, // 400
 9.522885224651072e-01, // 401
-1.129447390806947e-02, // 402
-2.328250486166383e-01, // 403
 8.239429906620959e-04, // 404
 1.176418694511150e-02, // 405
 2.527207656952961e-01, // 406
-3.424269197346751e+00, // 407
-1.414084256181953e-01, // 408
 2.261613550849727e-03, // 409
-4.768282116967812e-01, // 410
 3.320249981492121e+00, // 411
-6.450892737233001e-04, // 412
-8.172452015929962e+01, // 413
-1.788211764125082e+00, // 414
 1.233071656922576e+00, // 415
-9.750717401839945e-01, // 416
-5.880473899164952e+00, // 417
 2.849120399023876e+02, // 418
-2.431094655185551e+00, // 419
 2.125434475437620e-01, // 420
-2.315486960389526e+01, // 421
 8.306416250069555e-04, // 422
-4.304128035636471e-01, // 423
-1.297166781286814e-01, // 424
-1.230479344751477e-03, // 425
 3.196549690096002e-06, // 426
-5.350507717184359e+00, // 427
-8.290239835635084e+00}; // 428
    k_HH_intra =  1.975327500640361e-01; // A^(-1)
    k_OH_intra =  2.617953180072867e-01; // A^(-1)
    k_XH_coul =  4.677981536517541e-01; // A^(-1)
    k_XO_coul =  8.328591854489560e-01; // A^(-1)
    k_xlp_main =  7.425459819690536e-01; // A^(-1)
    d_HH_intra =  7.395636139500104e-01; // A^(-1)
    d_OH_intra =  1.999982215501664e+00; // A^(-1)
    d_XH_coul =  5.786908831939904e+00; // A^(-1)
    d_XO_coul =  6.999937722802333e+00; // A^(-1)
    d_xlp_main =  6.999670438271242e+00; // A^(-1)
    in_plane_gamma = -9.721486914088159e-02;
    out_of_plane_gamma =  9.859272078406150e-02;
    r2i =  5.500000000000000e+00; // A
    r2f =  6.500000000000000e+00; // A
  }

  // Iodide
  if (mon1 == "h2o" && mon2 == "i") {
    twobodyfit = std::vector<double> {
-1.773482623372680e+01, // 0
-2.140248209580141e+02, // 1
 8.521157262292053e+01, // 2
 2.083829964783616e+02, // 3
 4.241006589866826e+01, // 4
 1.425450385375190e+02, // 5
 4.855615153015506e+02, // 6
-1.840557386416943e+02, // 7
 2.172102202035387e+02, // 8
-9.160332037997586e+01, // 9
 1.967545932503488e+01, // 10
 1.316663595937647e+01, // 11
-5.067266897839993e+01, // 12
-2.694104777081353e+02, // 13
-1.293118404545595e+02, // 14
-6.523181017809871e+01, // 15
-2.064875498056167e+02, // 16
 1.646316600677281e+02, // 17
 3.341614543491683e+02, // 18
 1.297868056058606e+02, // 19
 2.084283848993133e+02, // 20
 2.312476821596866e+02, // 21
 3.649746787723616e+02, // 22
 2.909991414598997e+00, // 23
-8.030993315044132e+00, // 24
 5.060360454046483e+02, // 25
-8.876186320285059e+01, // 26
 6.543580775124428e+01, // 27
 5.529129899323242e+01, // 28
 1.333363427769170e+01, // 29
-2.922935887603409e+02, // 30
-1.824416284416330e+02, // 31
 6.637737939438138e+01, // 32
 9.678069403409619e+00, // 33
-4.912499176290328e+02, // 34
 3.070632049326501e+01, // 35
-1.049992505129529e+01, // 36
-7.239878919673736e+02, // 37
 9.144598218264893e+00, // 38
-1.881116479941586e+02, // 39
-5.060021595065986e+02, // 40
-1.146029730550141e+02, // 41
 6.263729571367688e-02, // 42
-1.862827538530815e+01, // 43
 2.063748841259908e+02, // 44
-5.030403847420322e+01, // 45
 4.873378357265082e+01, // 46
 6.043225107213873e+02, // 47
-1.869384183455026e+02, // 48
 2.864508962955330e+02, // 49
-6.698345265682089e+01, // 50
-3.086295602347072e+01, // 51
-2.239062872841442e+01, // 52
 6.450966399938369e+01, // 53
-1.525838294386640e+02, // 54
-1.430273695793520e+00, // 55
-2.598366174613457e+00, // 56
 2.620760412083429e+02, // 57
-2.273605664371653e+02, // 58
-2.866544561364394e+02, // 59
-7.199184190076216e+00, // 60
 8.195053623970787e+01, // 61
-2.174284914086984e+01, // 62
 3.604728817193516e+01, // 63
 1.698703637584797e+02, // 64
-4.627134381579046e+01, // 65
 1.329924400108029e+02, // 66
-1.909440080257422e+02, // 67
 8.610133129611199e+02, // 68
 2.355231982271347e+01, // 69
 1.454414634013269e+00, // 70
 2.665192973727844e+01, // 71
 1.952001755044090e+01, // 72
 1.200914479312618e+02, // 73
 3.060569161701276e+02, // 74
-6.328988166334891e+00, // 75
-2.226429197037536e+02, // 76
-5.935774750564163e+01, // 77
-4.672521908252465e+02, // 78
 8.457123578820605e+01, // 79
-7.785041824306352e-01, // 80
-6.250620651187073e+01, // 81
 9.863255231288591e+01, // 82
-7.847732864712445e-02, // 83
-9.917757745488990e+00, // 84
-3.145805637126131e+00, // 85
 1.712050412521197e+02, // 86
 2.346910121340865e+02, // 87
-1.100625754964854e+01, // 88
 9.050229692112832e+01, // 89
 6.355787418376908e-01, // 90
-1.106986737527424e+02, // 91
 1.385750998208958e-02, // 92
-2.836040091207117e+02, // 93
 1.613670045123786e+02, // 94
 2.317730910867770e+02, // 95
 4.252581391335633e+02, // 96
-4.466693893509339e+01, // 97
 1.501704079183079e+01, // 98
-2.304338376423129e+02, // 99
 3.872132546910447e+00, // 100
 2.609787367684596e+00, // 101
-1.819685525597735e+02, // 102
 3.973783034121637e+02, // 103
-1.569251336322836e+02, // 104
-5.152251135441260e+02, // 105
 1.834458619374553e+01, // 106
-9.232331074507420e+01, // 107
-4.929551910014253e+01, // 108
 4.189891223199552e+02, // 109
 2.429959841797227e+00, // 110
 1.279865749516312e+01, // 111
-1.470970368002415e+00, // 112
-8.032904735872994e-01, // 113
-3.361534333175768e+01, // 114
-1.297572276284565e+01, // 115
-4.762069134875537e+01, // 116
 2.080130238959072e+02, // 117
 4.321296963059422e+01, // 118
-7.930471345890479e-01, // 119
-2.766391388874678e+01, // 120
 1.060318499510591e+02, // 121
-1.982677733202197e-03, // 122
 1.582857187142812e+02, // 123
-3.065553653073813e+00, // 124
 1.104595542606342e+01, // 125
-4.634589417360468e+01, // 126
-4.678856163230327e+02, // 127
 5.851971937886078e+01, // 128
-1.252655873043277e+02, // 129
 6.929146160119510e+00, // 130
-1.638475576405718e+02, // 131
-1.732296512680799e+02, // 132
-5.920887246312876e+02, // 133
 1.168937625537476e+01, // 134
-4.852270812385509e-01, // 135
 9.967607985736400e+01, // 136
 1.696435765005751e+02, // 137
-9.381004445946014e+01, // 138
 5.469936251823017e+01, // 139
 1.448393496034924e+00, // 140
-2.806776002505935e+02, // 141
 4.222512588522759e+00, // 142
-5.158481378365809e+01, // 143
 4.815494915058677e+02, // 144
-8.485094314626886e-01, // 145
-3.938939497881839e+02, // 146
-1.096635837444685e+02, // 147
-8.814541995481919e+00, // 148
-5.870022552625647e-01, // 149
-4.961651602073545e+02, // 150
 7.743514635854334e+01, // 151
-6.590238097835069e+01, // 152
-2.655520748396066e-01, // 153
 3.559156757044537e-04, // 154
 5.592041379545345e+01, // 155
 3.177590577274840e+02, // 156
-1.358410753270401e+02, // 157
 8.264818337899738e-03, // 158
 1.390064930880193e+02, // 159
-1.290360924691234e+00, // 160
-8.150383117592257e+00, // 161
 8.779388543014042e+01, // 162
 1.421251845122990e+02, // 163
-2.708939943021007e+02, // 164
-7.892023781542179e+00, // 165
 3.163433033810094e+02, // 166
 1.322067061756619e+00, // 167
-9.621013711687157e+00, // 168
 8.693436094085230e+01, // 169
-7.063540363749302e+00, // 170
-4.270815223824017e+01, // 171
 3.225506302077383e+01, // 172
-4.569185332387263e+00, // 173
-1.841249894279083e+02, // 174
 7.908331625752689e+01, // 175
-1.289944069518756e+00, // 176
-3.342548882823090e+01, // 177
-8.954042999046704e+00, // 178
-8.681584150292787e+01, // 179
-3.832927931550883e-02, // 180
 1.247120136250455e+02, // 181
 6.787201550298346e+01, // 182
 5.309264182785284e+00, // 183
 9.411673331985274e+01, // 184
-1.497553048904613e+01, // 185
-3.516181733283560e+00, // 186
 2.780062439416197e+01, // 187
-6.137902179496321e-01, // 188
-1.971608064025247e+00, // 189
 2.362806334936169e+02, // 190
-2.274866788752232e+02, // 191
 8.350667700844233e-02, // 192
-1.990115523259981e+01, // 193
-2.834084375699157e+02, // 194
-4.465148459150929e+01, // 195
 9.907679029122038e-01, // 196
 2.593421339745718e+01, // 197
-2.134766241159824e+02, // 198
 6.917408871426516e-01, // 199
 1.308926492512980e+02, // 200
-3.506354903252473e-02, // 201
 3.181909236295068e+00, // 202
 8.756415713877034e+01, // 203
 1.387831262941615e+02, // 204
 7.959845482264824e+02, // 205
-3.515779465139587e+01, // 206
 6.565588058627188e+00, // 207
-1.784992553719794e+02, // 208
-2.739378728608582e+01, // 209
 1.640423003274798e-03, // 210
-3.195902274320702e-02, // 211
 2.711416513584874e+00, // 212
-5.995705166066792e-03, // 213
 8.316171957280700e+00, // 214
 3.183786626109142e+01, // 215
 2.123374818073658e+02, // 216
-9.224654783789983e+00, // 217
-5.936697464895801e+01, // 218
-3.795162615773984e-01, // 219
-1.362982917002277e+00, // 220
 1.325799740808909e-01, // 221
 2.965405535579574e-01, // 222
 1.533401665191108e-01, // 223
-1.056588064554676e-01, // 224
-6.613795288629560e+00, // 225
 2.610863532791863e-01, // 226
 1.416006413567705e-01, // 227
-1.124137291427709e+01, // 228
-4.344547541173685e+01, // 229
 1.775899578026126e+01, // 230
 5.332126015973792e-01, // 231
 1.569281451815573e+02, // 232
-4.639804977481976e+00, // 233
-1.006382160460234e-02, // 234
-4.399501589648256e+01, // 235
-3.418922677061075e-01, // 236
-4.768732095486066e+01, // 237
 7.292811184278364e+01, // 238
-1.618114162071874e+02, // 239
-6.977959559640821e+02, // 240
-3.656401068152675e+00, // 241
 5.141484301602675e-01, // 242
 6.868269242852538e+00, // 243
-5.625294728366455e-02, // 244
-1.263214278339738e-02, // 245
 6.490901702786866e+01, // 246
 1.087333512803102e-02, // 247
-5.760482327067280e+01, // 248
-5.228892725648695e-01, // 249
-2.586452296276352e+00, // 250
-1.552425950463039e+01, // 251
 6.987569856189599e+01, // 252
-5.554694464834764e+00, // 253
 2.036907205655253e+02, // 254
 1.791766706410295e+01, // 255
 1.960408243998266e+00, // 256
 6.764155523421939e+02, // 257
 1.160274640825975e-03, // 258
-1.338176403062932e+02, // 259
 1.032901819558933e+02, // 260
 3.449973966483613e-01, // 261
-6.204946739166672e-01, // 262
 2.277840194058340e+01, // 263
-8.826308496038925e+00, // 264
-6.453172805837180e+00, // 265
 4.163810328267653e-01, // 266
-1.336581347863053e+02, // 267
-2.388743129486098e-02, // 268
 1.917927066776284e-04, // 269
 8.226120685899987e+00, // 270
 4.327079344807200e-01, // 271
 1.645683972522849e+02, // 272
-1.380182469410576e+01, // 273
-4.450374974230281e+00, // 274
 1.831501756861362e-01, // 275
-2.387146783180143e+01, // 276
 4.240084643251501e-05, // 277
-6.701412645593041e+00, // 278
 9.001680332076837e+01, // 279
 1.264522966858471e+01, // 280
 1.679469809272677e+01, // 281
-1.942880769661498e+02, // 282
-3.060846575846658e+02, // 283
-4.111093129255634e-01, // 284
 3.549410831465262e+00, // 285
 1.505356130174997e+02, // 286
-7.104663259541877e-02, // 287
 1.897178310081747e-01, // 288
-4.243862132956588e+00, // 289
 3.788909725764981e+00, // 290
 4.544653696207566e+00, // 291
 8.642032126876297e+00, // 292
-2.692088090004053e+00, // 293
-3.207547427441205e+02, // 294
 4.859403733579065e+00, // 295
 4.448692681504390e+00, // 296
 2.321826273977094e+01, // 297
 5.891918782498214e-03, // 298
 1.677277746800477e-02, // 299
-3.779366439437380e+01, // 300
 1.489851634115554e+01, // 301
 6.271539375649843e-01, // 302
-7.174189334228221e+00, // 303
 3.232425671659833e-02, // 304
-1.551802840271304e+02, // 305
-1.286327331142391e+02, // 306
 5.795152581603549e-02, // 307
 1.137597394542182e+02, // 308
 2.773902868525303e-01, // 309
 5.678859380142059e+01, // 310
 2.943563774654411e+01, // 311
-2.326170697689705e+00, // 312
 5.663870368221560e+00, // 313
-2.787849516883015e-01, // 314
 3.456454873813232e+01, // 315
-6.447818376680223e+00, // 316
 1.741708568578813e+02, // 317
 2.432666864217423e+00, // 318
-1.863419255500891e+01, // 319
-4.856596537071352e-01, // 320
-1.523753415943497e+02, // 321
 1.970459206281247e+01, // 322
-4.613099566936477e+00, // 323
 9.961537365559948e-03, // 324
 1.461634072265730e+02, // 325
-6.968571507238482e+01, // 326
 1.214323192433223e+01, // 327
-1.621126301676008e+01, // 328
-3.684981399384102e+00, // 329
-2.958483615076223e-03, // 330
-1.604867014782017e+02, // 331
-1.199189612323233e+02, // 332
-9.639971302756214e+01, // 333
 8.475027395917827e+00, // 334
-2.736902842271686e-02, // 335
 2.504504079239369e+01, // 336
-9.678176951531638e-01, // 337
-1.634572327959750e+01, // 338
-8.281053057887151e+01, // 339
-6.308914467444429e-02, // 340
-1.229812474300924e+01, // 341
-3.237696784586605e+00, // 342
-8.865316049768934e+00, // 343
 1.914822716895893e+00, // 344
-3.454153179168800e+02, // 345
-5.072801397866027e-02, // 346
 2.389184923945013e+01, // 347
 5.355337433652005e+02, // 348
-5.286080960571233e+00, // 349
 4.163765308779094e-01, // 350
 2.511822235450016e+00, // 351
 1.708733042345639e+02, // 352
 9.949408105592620e-03, // 353
-4.140879759999406e-01, // 354
-2.202410044543435e+01, // 355
 1.428314432576971e+02, // 356
 5.756464385233243e-01, // 357
 7.909090568531283e+01, // 358
-4.363657080979583e+00, // 359
 1.824491716484090e-01, // 360
 8.803989843618308e-04, // 361
-6.979250986966028e+01, // 362
 9.653186402433704e+01, // 363
-1.850829324212494e-02, // 364
 9.056982539941791e+01, // 365
-2.121693775197740e-02, // 366
-1.426161989984641e+02, // 367
 2.145433684337848e+00, // 368
 4.291233383020249e-02, // 369
-5.473995905457542e-03, // 370
 1.429466617986896e+02, // 371
-3.298872866044258e-03, // 372
-6.463025009448224e+00, // 373
 1.651119521754443e+02, // 374
-1.171771057908039e+02, // 375
-9.396474400808728e+00, // 376
 5.597021265100160e+01, // 377
-3.878203194539348e+01, // 378
-4.381311473885700e+00, // 379
-2.338203387788907e-02, // 380
-3.463107531348581e+00, // 381
 8.500590145226603e-01, // 382
 1.192381214697398e+00, // 383
-1.125010062948513e+03, // 384
 9.263797670510989e+01, // 385
 1.486297923903624e-03, // 386
-6.656531978620629e+01, // 387
-1.147679890856839e+02, // 388
 2.499013693597929e+01, // 389
 2.861628849662389e-01, // 390
-9.903380952747054e+01, // 391
-7.917761705351335e+00, // 392
-1.581904714831282e-01, // 393
-1.246964676892449e-01, // 394
 7.535038675683120e-01, // 395
 1.889002625654320e-01, // 396
 2.586426265338965e+00, // 397
-7.209282101102323e+01, // 398
 9.509502195417354e-01, // 399
 1.286369581796744e+00, // 400
 3.550850054908031e-01, // 401
-5.841600440714230e-01, // 402
-3.094747423406467e+01, // 403
 2.391008456614779e+00, // 404
 4.697374843505131e+01, // 405
 2.637813794228305e-02, // 406
 1.900802347774659e-01, // 407
 7.748347313764366e-03, // 408
 6.747401194325975e+00, // 409
-7.454967707790446e+01, // 410
-2.121131731834596e+01, // 411
-2.232209341038021e+01, // 412
 2.631956886618677e+02, // 413
-1.019600232723830e+01, // 414
 5.513073717576862e+00, // 415
-1.010134739366824e+00, // 416
-2.266346213716591e-01, // 417
 3.831696935279621e+02, // 418
-1.234239881916514e-01, // 419
 5.945741432070180e+01, // 420
-2.263413571204271e+01, // 421
 9.206792802542389e-03, // 422
-1.290381492018790e-02, // 423
-6.171918595093247e-04, // 424
-6.237771823980852e-06, // 425
-5.630083818921239e+00, // 426
-1.736691093312316e+02, // 427
 5.179431235848446e+00}; // 428
  k_HH_intra =  2.395803501541666e-01; // A^(-1)
  k_OH_intra =  3.199632634288028e-01; // A^(-1)
  k_XH_coul =  3.584717215776750e-01; // A^(-1)
  k_XO_coul =  1.060518455619103e+00; // A^(-1)
  k_xlp_main =  7.110019858173235e-01; // A^(-1)
  d_HH_intra =  1.998665530149493e+00; // A^(-1)
  d_OH_intra =  1.097067844744283e+00; // A^(-1)
  d_XH_coul =  6.675491273907575e+00; // A^(-1)
  d_XO_coul =  6.999828434717365e+00; // A^(-1)
  d_xlp_main =  4.300488404077194e+00; // A^(-1)
  in_plane_gamma = -9.721486914088159e-02;
  out_of_plane_gamma =  9.859272078406150e-02;
  r2i =  6.000000000000000e+00; // A
  r2f =  7.000000000000000e+00; // A
  }
}

//----------------------------------------------------------------------------//

double x2b_h2o_ion_v2x::f_switch(const double& r, double& g)
{
    if (r > r2f) {
        g = 0.0;
        return 0.0;
    } else if (r > r2i) {
        const double t1 = M_PI/(r2f - r2i);
        const double x = (r - r2i)*t1;
        g = - std::sin(x)*t1/2.0;
        return (1.0 + std::cos(x))/2.0;
    } else {
        g = 0.0;
        return 1.0;
    }
}

//----------------------------------------------------------------------------//

double x2b_h2o_ion_v2x::eval(const double* w1, const double* x,
                             const size_t nd) {
  std::vector<size_t> dimers_todo;
  std::vector<double> energy (nd,0.0);
  double rabsq[nd];
  double rab[nd];
  double dab[3*nd];
  for (size_t i = 0; i < nd; i++) {
    dab[3*i] = w1[9*i+0] -   x[3*i+0];
    dab[3*i+1] = w1[9*i+1] - x[3*i+1];
    dab[3*i+2] = w1[9*i+2] - x[3*i+2];

    rabsq[i] = dab[3*i+0]*dab[3*i+0]
             + dab[3*i+1]*dab[3*i+1]
             + dab[3*i+2]*dab[3*i+2];
    rab[i] = std::sqrt(rabsq[i]);

    if (rab[i] > r2f)
        continue;

    dimers_todo.push_back(i);
  }

  double vv[8 * dimers_todo.size()];

  for (size_t i = 0; i < dimers_todo.size(); i++) {
    // offsets
    size_t sh = dimers_todo[i];
    size_t sh3 = sh * 3;
    size_t sh9 = sh3 * 3;

    const int O  = 0;
    const int H1 = 3;
    const int H2 = 6;

    const int X  = 9;

    const int lp1 = 12;
    const int lp2 = 15;

    double xcrd[18]; // coordinates including extra-points
 
    std::copy(w1 + sh9, w1 + sh9 + 9, xcrd);
    std::copy( x + sh3, x + sh3 + 3, xcrd + 9);

    // Set lone pairs
    monomer m;
    m.setup(xcrd + O, in_plane_gamma, out_of_plane_gamma,
             xcrd + lp1, xcrd + lp2);

    // Get the polynomial monomials
    variable ctxt[8];
    double v[8];

    v[0] = ctxt[0].v_exp(d_HH_intra, k_HH_intra, xcrd, H1, H2);

    v[1] = ctxt[1].v_exp(d_OH_intra, k_OH_intra, xcrd, O, H1);
    v[2] = ctxt[2].v_exp(d_OH_intra, k_OH_intra, xcrd, O, H2);

    v[3] = ctxt[3].v_coul(d_XH_coul, k_XH_coul, xcrd, X, H1);
    v[4] = ctxt[4].v_coul(d_XH_coul, k_XH_coul, xcrd, X, H2);

    v[5] = ctxt[5].v_coul(d_XO_coul, k_XO_coul, xcrd, X, O);

    v[6] = ctxt[6].v_exp(d_xlp_main, k_xlp_main, xcrd, X, lp1);
    v[7] = ctxt[7].v_exp(d_xlp_main, k_xlp_main, xcrd, X, lp2);
 
    for (size_t j = 0; j < 8; j++) {
      vv[j*dimers_todo.size() + i] = v[j];
    }
  }
 
  std::vector<double> e2b = poly_2b_h2o_ion_v1x::eval(dimers_todo.size(),
                                 twobodyfit.data(), vv);
 
  for (size_t i = 0; i < dimers_todo.size(); i++) {
    energy[dimers_todo[i]] = e2b[i];
  }

  // the switch
  double e = 0.0;
  for (size_t i = 0; i < nd; i++) {
    double gsw;
    const double sw = f_switch(rab[i], gsw);

    e += sw*energy[i];
  }

  return e;
}

//----------------------------------------------------------------------------//

double x2b_h2o_ion_v2x::eval(const double* w1, const double* x, 
                             double* g1, double* g2, const size_t nd) {

  std::vector<size_t> dimers_todo;
  std::vector<double> energy (nd,0.0);
  double rabsq[nd];
  double rab[nd];
  double dab[3*nd];
  for (size_t i = 0; i < nd; i++) {
    dab[3*i] = w1[9*i+0] -   x[3*i+0];
    dab[3*i+1] = w1[9*i+1] - x[3*i+1];
    dab[3*i+2] = w1[9*i+2] - x[3*i+2];

    rabsq[i] = dab[3*i+0]*dab[3*i+0]
             + dab[3*i+1]*dab[3*i+1]
             + dab[3*i+2]*dab[3*i+2];
    rab[i] = std::sqrt(rabsq[i]);

    if (rab[i] > r2f)
        continue;

    dimers_todo.push_back(i);
  }

  size_t ndtd = dimers_todo.size();
  double vv[8 * ndtd];
  double gg[8 * ndtd];
  variable ctxt[8 * ndtd];
  monomer m[ndtd];
  double e = 0.0;

  for (size_t i = 0; i < ndtd; i++) {
    // offsets
    size_t sh = dimers_todo[i];
    size_t sh3 = sh * 3;
    size_t sh9 = sh3 * 3;

    const int O  = 0;
    const int H1 = 3;
    const int H2 = 6;

    const int X  = 9;

    const int lp1 = 12;
    const int lp2 = 15;

    double xcrd[18]; // coordinates including extra-points

    std::copy(w1 + sh9, w1 + sh9 + 9, xcrd);
    std::copy( x + sh3, x + sh3 + 3, xcrd + 9);

    // Set lone pairs
    m[i].setup(xcrd + O, in_plane_gamma, out_of_plane_gamma,
             xcrd + lp1, xcrd + lp2);

    // Get the polynomial monomials
    double v[8];

    v[0] = ctxt[i*8 + 0].v_exp(d_HH_intra, k_HH_intra, xcrd, H1, H2);

    v[1] = ctxt[i*8 + 1].v_exp(d_OH_intra, k_OH_intra, xcrd, O, H1);
    v[2] = ctxt[i*8 + 2].v_exp(d_OH_intra, k_OH_intra, xcrd, O, H2);

    v[3] = ctxt[i*8 + 3].v_coul(d_XH_coul, k_XH_coul, xcrd, X, H1);
    v[4] = ctxt[i*8 + 4].v_coul(d_XH_coul, k_XH_coul, xcrd, X, H2);

    v[5] = ctxt[i*8 + 5].v_coul(d_XO_coul, k_XO_coul, xcrd, X, O);

    v[6] = ctxt[i*8 + 6].v_exp(d_xlp_main, k_xlp_main, xcrd, X, lp1);
    v[7] = ctxt[i*8 + 7].v_exp(d_xlp_main, k_xlp_main, xcrd, X, lp2);

    for (size_t j = 0; j < 8; j++) {
      vv[j*dimers_todo.size() + i] = v[j];
    }
  }

  std::vector<double> e2b = poly_2b_h2o_ion_v1x::eval(ndtd,
                                 twobodyfit.data(), vv, gg);

  for (size_t i = 0; i < ndtd; i++) {
    // offsets
    size_t sh = dimers_todo[i];
    size_t sh3 = sh * 3;
    size_t sh9 = sh3 * 3;

    const int O  = 0;
    const int H1 = 3;
    const int H2 = 6;

    const int X  = 9;

    const int lp1 = 12;
    const int lp2 = 15;

    double xgrd[18];
    std::fill(xgrd, xgrd + 18, 0.0);

    ctxt[i*8 + 0].grads(gg[0*ndtd + i], xgrd, H1, H2);

    ctxt[i*8 + 1].grads(gg[1*ndtd + i], xgrd, O, H1);
    ctxt[i*8 + 2].grads(gg[2*ndtd + i], xgrd, O, H2);

    ctxt[i*8 + 3].grads(gg[3*ndtd + i], xgrd, X, H1);
    ctxt[i*8 + 4].grads(gg[4*ndtd + i], xgrd, X, H2);

    ctxt[i*8 + 5].grads(gg[5*ndtd + i], xgrd, X, O);

    ctxt[i*8 + 6].grads(gg[6*ndtd + i], xgrd, X, lp1);
    ctxt[i*8 + 7].grads(gg[7*ndtd + i], xgrd, X, lp2);

    m[i].grads(xgrd + lp1, xgrd + lp2,
             in_plane_gamma, out_of_plane_gamma,
             xgrd + O);

    double gsw;
    const double sw = f_switch(rab[sh], gsw);

    for (size_t j = 0; j < 9; j++) {
        g1[j + sh9] += sw*xgrd[j];
    }
    for (size_t j = 0; j < 3; j++) {
        g2[j + sh3] += sw*xgrd[j + 9];
    }

    // gradient of the switch

    gsw *= e2b[i]/rab[sh];
    for (size_t j = 0; j < 3; ++j) {
        const double d = gsw*dab[sh3 + j];
        g1[j + sh9] += d;
        g2[j + sh3] -= d;
    }

    e += sw*e2b[i];
  }

  return e;
}

//----------------------------------------------------------------------------//

} // namespace h2o_ion

////////////////////////////////////////////////////////////////////////////////
