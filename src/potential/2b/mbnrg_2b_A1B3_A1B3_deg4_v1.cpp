#include "mbnrg_2b_A1B3_A1B3_deg4_v1.h"

////////////////////////////////////////////////////////////////////////////////

namespace mbnrg_A1B3_A1B3_deg4 {

mbnrg_A1B3_A1B3_deg4_v1::mbnrg_A1B3_A1B3_deg4_v1(const std::string mon1, const std::string mon2) {
    // =====>> BEGIN SECTION CONSTRUCTOR <<=====
    // =>> PASTE RIGHT BELOW THIS LINE <==
    if (mon1 == "nh3" and mon2 == "nh3") {
        coefficients = std::vector<double> {
            -4.009036550303865e+01, // 0
            -7.238280442370130e+01, // 1
             7.497899909071049e+01, // 2
            -2.619153705468739e+02, // 3
            -8.771697041926642e+01, // 4
             8.103543875740175e+01, // 5
             1.121275785069747e+02, // 6
            -8.512598308656888e+01, // 7
            -1.333955609240434e+02, // 8
             1.545754781049953e+02, // 9
             3.714110737005467e+01, // 10
             4.413235900600238e+01, // 11
             3.278428774439603e+02, // 12
             1.995074569582296e+02, // 13
            -3.697432615646257e+01, // 14
            -4.195959365172327e+01, // 15
             2.190555503558821e+02, // 16
             2.200894950123650e+02, // 17
            -4.811388557541958e+02, // 18
            -4.391637142622365e+01, // 19
            -3.460928881696670e+01, // 20
             1.942792634968951e+02, // 21
            -5.636227423896797e+01, // 22
             3.869335955471461e+00, // 23
            -1.191955358044184e+02, // 24
             1.769986004753544e+02, // 25
            -9.680921389454440e+01, // 26
             5.960475521513877e+02, // 27
             8.604714125116129e+01, // 28
            -6.476994435131326e+01, // 29
             1.969991018475669e+02, // 30
            -2.561868367529860e+02, // 31
             5.332870197984766e+02, // 32
            -5.307782065209059e+02, // 33
             1.369077790104320e+02, // 34
             1.406573501141508e+02, // 35
             2.360926258921389e+02, // 36
             2.600679777143371e+02, // 37
            -8.127634681370335e+00, // 38
            -7.421600480517334e+01, // 39
            -2.738878726475380e+02, // 40
             2.541340536363555e+02, // 41
            -2.029136040989579e+01, // 42
            -6.341163321723958e+01, // 43
            -3.491136568703656e+02, // 44
             3.157092613940300e+01, // 45
             1.159793336310300e+02, // 46
             2.604997944269591e+02, // 47
            -7.243739727709568e+01, // 48
            -8.856943941543308e+01, // 49
            -1.829963941010391e+02, // 50
            -1.791510473693132e+01, // 51
            -1.303514785388871e+02, // 52
            -2.032016948203275e+02, // 53
             1.443231963396731e+02, // 54
             5.421064682587757e+00, // 55
            -1.459086831045414e+02, // 56
             1.876090154398800e+01, // 57
            -3.108717739052769e+00, // 58
             2.299807162780196e+00, // 59
            -7.720141177910895e+02, // 60
            -5.675925118813607e+01, // 61
            -2.053631763311673e+01, // 62
            -1.314688193902591e+02, // 63
            -7.480560216297414e+01, // 64
             8.274180579518489e+01, // 65
             2.539708491937542e+02, // 66
             6.297739601845555e+01, // 67
             7.443897173649931e+00, // 68
            -2.628685233639763e+01, // 69
             2.005343824436208e+02, // 70
            -8.366732922836539e+01, // 71
             2.440495539303651e+02, // 72
            -2.365455316251461e+02, // 73
             2.173315800797646e+01, // 74
             2.339771770786282e+02, // 75
            -1.024490050531272e+01, // 76
            -6.810745192004616e+01, // 77
            -8.558216227940476e+01, // 78
            -2.096612888770220e+02, // 79
            -3.690298326509377e+01, // 80
            -1.393033303678054e+02, // 81
            -9.434975859140269e+01, // 82
             4.284209163647801e+02, // 83
            -1.312092568072224e+02, // 84
            -4.047264354426533e+02, // 85
            -1.101444702359667e+02, // 86
             3.303551867721145e+01, // 87
            -2.488693572313532e+01, // 88
             4.531454108014441e+01, // 89
            -7.372342533615146e+01, // 90
            -3.270445027579444e+01, // 91
             1.191523538900571e+02, // 92
             8.515654466178669e+02, // 93
             1.674544706021742e+01, // 94
             6.922181233840809e+01, // 95
             1.360086588474857e+02, // 96
             7.385942927084139e+01, // 97
             2.435216397112281e+02, // 98
             5.679418813088114e+01, // 99
            -1.342413488286731e+02, // 100
            -7.974337675190152e+01, // 101
            -4.314585266526031e+01, // 102
            -3.006676369476964e+02, // 103
             7.695816334053941e+02, // 104
             1.198464782705069e+02, // 105
             8.259584240152256e+01, // 106
            -5.511078716519277e+01, // 107
             1.919372078048664e+02, // 108
            -4.050949767115613e+02, // 109
            -3.052947874095454e+02, // 110
             2.942231174333272e+02, // 111
             4.595788736610552e+01, // 112
             1.919494653928675e+02, // 113
             1.362956707611427e+00, // 114
             1.706876174392447e+02, // 115
             3.606977157482004e+01, // 116
             2.220136247017554e+02, // 117
            -5.080295280853687e+01, // 118
             1.026321516253074e+02, // 119
             6.767494656717683e+01, // 120
             2.082813614026164e+02, // 121
             6.693456491791186e+01, // 122
            -2.039405197195831e+02, // 123
            -7.446267030288335e+01, // 124
            -6.961353274546974e+01, // 125
             2.660566212299125e+01, // 126
            -2.014840967636380e+01, // 127
            -3.330918172517106e+02, // 128
             1.616955692589570e+02, // 129
             2.003813232530329e+02, // 130
             1.724525808486439e+02, // 131
            -3.379468696553986e+02, // 132
            -6.387651960424665e+00, // 133
             6.232318594243961e+01, // 134
             2.652025571576103e+02, // 135
            -2.112796913414464e+02, // 136
            -1.187920283082944e+01, // 137
            -7.237948822728110e+01, // 138
            -4.768035391558869e+01, // 139
             7.394323836131829e+01, // 140
            -3.571490605192421e+02, // 141
            -2.179391975418123e+02, // 142
             2.468532797846928e+02, // 143
             9.864816215008902e+01, // 144
            -3.984834003047791e+01, // 145
            -1.447962604096685e+02, // 146
            -6.750021364773647e+01, // 147
             1.506805727416644e+02, // 148
            -2.121708553534091e+02, // 149
            -4.318486261245548e+02, // 150
             1.124182471621510e+02, // 151
            -2.026757001642640e+02, // 152
            -1.124604795612964e+02, // 153
             2.840740855412593e+02, // 154
            -5.350774192438090e+01, // 155
            -3.017856128752315e+01, // 156
            -1.470956827899809e+02, // 157
            -1.328957620121866e+02, // 158
             1.754030271303631e+02, // 159
             1.630156003893298e+02, // 160
             1.496052068130878e+02, // 161
            -9.259049231656419e+00, // 162
             6.038510096148334e+01, // 163
             2.323160742300487e+02, // 164
            -6.012450695944937e+01, // 165
             1.376975928363033e+02, // 166
            -5.872824084599785e+02, // 167
             5.516892118364142e+01, // 168
            -2.163295289469707e+00, // 169
            -4.803599110508584e+01, // 170
             7.288648528905860e+00, // 171
             2.484632623102812e+02, // 172
             1.428094798621474e+02, // 173
            -8.151958920758803e+00, // 174
            -2.205138578339909e+01, // 175
            -5.813814012240722e+01, // 176
             5.957670186910545e+01, // 177
            -1.256799292404785e+02, // 178
            -2.072091969827485e+02, // 179
            -4.643676985746684e+00, // 180
             2.297524760229865e+02, // 181
            -3.355227601190239e+02, // 182
            -3.458041570525932e+00, // 183
             8.494340152091122e+01, // 184
             4.367056633226656e+02, // 185
            -3.516084483911634e+02, // 186
            -1.224057451659623e+01, // 187
            -3.784380032628491e+02, // 188
             1.902421366901257e+01, // 189
             3.631127231628375e+02, // 190
            -2.198718106463114e+02, // 191
             1.207596302733779e+02, // 192
             8.345925483277254e+01, // 193
             9.456983873229997e+01, // 194
             1.926184320044960e+01, // 195
             2.574207792678395e+00, // 196
            -2.718104260747142e+02, // 197
             1.452575576628972e+03, // 198
            -7.481288265512981e+01, // 199
             3.964658051003215e+02, // 200
            -2.031955812950013e+02, // 201
             3.198444641939639e+02, // 202
            -1.527861755488059e+02, // 203
             1.028063521662866e+02, // 204
            -2.582772535798964e+02, // 205
            -2.628206478596708e+02, // 206
             2.109942020515712e+02, // 207
             4.701155987122658e+02, // 208
            -2.465006182233957e+01, // 209
             2.330814124841977e+02, // 210
            -1.139430199983007e+02, // 211
            -1.652799789656434e+02, // 212
            -7.878140302386302e+01, // 213
             3.673544488369894e+01, // 214
             2.415427728928839e+02, // 215
             6.912332507061910e+02, // 216
             2.012861965263021e+02, // 217
             4.326158938198706e+01, // 218
            -1.694874994926846e+02, // 219
             1.129816300864413e+01, // 220
            -4.928486854146072e+02, // 221
             3.228741362306152e+01, // 222
             1.479846422069278e+02, // 223
            -8.890435892571293e+01, // 224
            -3.252475685196062e+01, // 225
            -1.848967635651888e+02, // 226
            -2.646573962281389e+02, // 227
            -3.768653010245774e+01, // 228
             8.610464641438200e+01, // 229
            -2.515113841052199e+02, // 230
            -9.088544152350474e+01, // 231
            -2.874539435481301e+03, // 232
             4.383551031531162e+01, // 233
             5.191595950222722e+02, // 234
             2.470881066729944e+00, // 235
             2.137575377425335e+02, // 236
             1.909483275183711e+02, // 237
            -2.844901748560265e+02, // 238
             7.425011096102393e+00, // 239
             8.601119320823935e+00, // 240
            -1.087146422129840e+02, // 241
            -7.054712557544342e+01, // 242
            -1.565315083613139e+01, // 243
            -1.758485277531114e+02, // 244
            -4.405701713534781e+01, // 245
             6.072842092573970e+02, // 246
             6.641910455287844e+01, // 247
             2.173052611698866e+02, // 248
             4.643606107774490e+01, // 249
             2.611770334088250e+02, // 250
             7.402300054591647e+01, // 251
            -1.189997710552607e+01, // 252
             3.583287783369733e+01, // 253
             1.765569447601806e+02, // 254
             2.917250750842878e+02, // 255
             7.811436333773926e+01, // 256
             3.342528376818109e+02, // 257
             2.615815955129039e+01, // 258
             5.240663002988416e+02, // 259
            -5.854467021707335e+02, // 260
             6.162675361333772e+01, // 261
            -6.510105239053105e+01, // 262
             3.258830311584575e+02, // 263
            -7.117602507061648e+01, // 264
            -8.157908115038312e+01, // 265
            -4.753549136895535e+00, // 266
            -5.614448904679118e+02, // 267
             1.299736670430556e+02, // 268
            -1.872785565340362e+02, // 269
             1.184895140280408e+02, // 270
            -6.234032209625170e+01, // 271
             6.237320654131382e+02, // 272
            -4.612319715509109e+01, // 273
             2.017848421476029e+02, // 274
             8.849273629155538e+02, // 275
             3.034401258853497e+02, // 276
             3.432584387940171e+01, // 277
             3.891661225875879e+02, // 278
            -1.276145059046536e+02, // 279
             1.838471727915376e+02, // 280
            -1.646697970380502e+02, // 281
             2.692882111958181e+01, // 282
            -2.752098423751277e+02, // 283
            -1.631048198521764e+02, // 284
            -2.196035475676318e+02, // 285
            -3.978316264662531e+02, // 286
            -1.882631303882004e+02, // 287
            -1.837315386372236e+02, // 288
             7.073105790284256e+01, // 289
             1.372200740457159e+02, // 290
            -3.065238421208007e+02, // 291
             2.377497810974147e+01, // 292
             3.344708370224462e+02, // 293
             3.667552413082087e+01, // 294
            -1.309448233922553e+02, // 295
            -2.773722117980876e+02, // 296
            -4.883584751057637e+02, // 297
            -1.465402408920071e+03, // 298
             6.493687319454451e+02, // 299
             4.927751118763452e+01, // 300
             2.470544391041871e+02, // 301
            -1.310326065670092e+01, // 302
             7.005664414489006e+01, // 303
             4.897001078736174e+02, // 304
            -3.269727702287728e+02, // 305
            -6.337186911886162e+01, // 306
            -2.419890304391213e+02, // 307
            -2.685124865588490e+02, // 308
             8.199943341675511e+02, // 309
            -1.043037476280451e+02, // 310
            -5.903525464564239e+02, // 311
             1.754324915907912e+02, // 312
            -5.954986561068305e+02, // 313
             6.145865291809396e+02, // 314
            -1.181249959526082e+02, // 315
             3.014597610941448e+01, // 316
             1.266299634386615e+01, // 317
            -9.477152950335363e+01, // 318
            -8.962260463044037e+00, // 319
             2.145607020763786e+01, // 320
             1.148364260921932e+02, // 321
             2.707215365290237e+01, // 322
            -6.962368430016434e+02, // 323
             3.009181323237781e+01, // 324
             4.636262566803482e+01, // 325
            -3.617995828069036e+01, // 326
             2.325710215294298e+02, // 327
             9.714450026059724e+01, // 328
            -2.645860889846797e+02, // 329
            -1.748527053458654e+02, // 330
            -8.269214519897422e+01, // 331
            -5.451522268235434e+01, // 332
             1.051385095754949e+02, // 333
            -4.580268304391906e+02, // 334
             4.308827408054995e+01, // 335
            -2.402158209526869e+02, // 336
             1.016007573233711e+03, // 337
            -2.925914081431277e+02, // 338
             1.936693378759867e+02, // 339
             1.169522348390279e+02, // 340
            -1.481737141369710e+02, // 341
             9.433967512932236e+01, // 342
             2.395202443294947e+01, // 343
            -3.490490848548573e+00, // 344
            -2.611650682259965e+01, // 345
            -2.392600566905893e+02, // 346
             3.049713465838014e+01, // 347
            -2.235031378888652e+02, // 348
             5.616277909182631e+02, // 349
            -2.373669367409873e+02, // 350
            -1.936749855376930e+03, // 351
            -5.368410064194725e+02, // 352
             9.914152344743941e+01, // 353
            -3.892590680374770e+02, // 354
             5.428298742275171e+02, // 355
            -2.721856834024123e+02, // 356
             6.393681467669067e+01, // 357
             1.420249334643973e+02, // 358
            -8.441883703129352e+01, // 359
            -1.954429949240744e+02, // 360
             1.834344786029589e+02, // 361
             2.246251797982275e+02, // 362
            -3.306690072749893e+02, // 363
            -4.875564633410087e+00, // 364
             8.655205027746611e-01, // 365
            -7.411248587107060e+01, // 366
             2.508201512183467e+02, // 367
            -4.381143745077350e+02, // 368
            -6.546129357804576e+02, // 369
            -2.633282945193525e+02, // 370
            -1.450847279925061e+01, // 371
             5.177172402833704e+02, // 372
            -4.743788555385426e+02, // 373
            -2.712225451248465e+02, // 374
            -1.755074874600527e+02, // 375
            -3.583674448038781e+02, // 376
            -2.720210247490268e+01, // 377
            -4.807765558743968e+01, // 378
            -1.998652069431614e+01, // 379
            -6.166158689521375e+02, // 380
            -7.874882953331015e+02, // 381
             3.745265010549766e+01, // 382
            -1.052647758093208e+02, // 383
            -4.990386597753501e+01, // 384
            -7.150628029259586e+02, // 385
             2.443181192266396e+01, // 386
             3.464545450338888e+02, // 387
             2.346537595029413e+01, // 388
             2.080465080135020e+02, // 389
             2.519468115845529e+02, // 390
            -1.919627052151587e+02, // 391
             2.907098384347998e+02, // 392
             2.430607964217201e+01, // 393
            -2.421061804771879e+02, // 394
            -9.848429878039532e+01, // 395
             4.358943912368332e+02, // 396
            -2.196291812699449e+02, // 397
            -9.328132615040410e+01, // 398
             1.159584847467888e+02, // 399
             1.140351801514855e+01, // 400
            -3.867399666219226e+02, // 401
            -4.208853028594266e+01, // 402
             9.197134173045312e+01, // 403
            -3.477404957202693e+02, // 404
            -2.529464004570472e+02, // 405
            -2.525201256065775e+02, // 406
            -1.860097713306587e+02, // 407
             4.645680063034208e+01, // 408
             1.255396537518528e+03, // 409
             8.788569221278753e+01, // 410
            -1.074735096544306e+02, // 411
             1.155916935409905e+03, // 412
            -4.934913099246260e+02, // 413
            -4.965877890442650e+02, // 414
             8.926140211922979e+01, // 415
             2.526317975283917e+02, // 416
             3.833100707898567e+01, // 417
            -3.659431237348942e+02, // 418
            -2.556194730008510e+02, // 419
            -1.234703390389674e+02, // 420
             5.896852137420900e+01, // 421
            -2.969231562230067e+02, // 422
            -1.175748916359207e+02, // 423
            -5.393546432933705e+02, // 424
            -5.108825250508465e+02, // 425
            -1.199532488037036e+02, // 426
            -8.683434885973726e+00, // 427
            -5.673404359467721e+01, // 428
             4.783190552285740e+01, // 429
            -2.710182223181017e+02, // 430
             1.876692952908321e+02, // 431
            -1.034492653771071e+00, // 432
             5.386600896734296e+02, // 433
             2.984574402262211e+02, // 434
             3.180179172780111e+01, // 435
            -1.495661160506665e+02, // 436
             3.450279624517081e+02, // 437
            -1.769287549788385e+01, // 438
            -5.701632083306928e+00, // 439
             5.936016147979659e+00, // 440
            -5.472522501362504e+01, // 441
             1.491447774915662e+01, // 442
             3.100688265349811e+02, // 443
            -6.725093603149337e+01, // 444
            -8.477606818870282e+01, // 445
             2.047645396463984e+01, // 446
             5.968284443753944e+02, // 447
             1.522707383188880e+02, // 448
             1.335819436535136e+02, // 449
             5.634358132402415e+02, // 450
             1.045172231672100e+03, // 451
            -9.914505272456171e+02, // 452
            -9.985088937732235e+01, // 453
             1.828180124893171e+02, // 454
             9.516806017641337e+02, // 455
            -2.179763427228485e+01, // 456
             2.283795904579710e+01, // 457
            -4.293775367219148e+02, // 458
             2.370335318369596e+02, // 459
            -8.367719312014408e+02, // 460
            -7.413986421256544e+02, // 461
             4.605456265799302e+01, // 462
            -3.502635190572616e+01, // 463
            -1.404327587533917e+02, // 464
             1.342039362387528e+03, // 465
            -6.645991628880714e+02, // 466
             8.341672019218764e+00, // 467
             8.065962154180396e+01, // 468
             2.877647277210122e+00, // 469
            -5.464080938278018e+02, // 470
            -1.437524494759716e+02, // 471
             1.024435975686832e+01, // 472
            -1.859591738363043e+02, // 473
            -6.403276992663457e+02, // 474
            -5.622289369097398e+02, // 475
             7.298810433229778e+02, // 476
             1.112359625703226e+03, // 477
            -7.359900835582206e+02, // 478
            -2.572984776817494e+02, // 479
            -7.955898908746342e+01, // 480
             1.706187076173248e+02, // 481
             2.138655056642288e+02, // 482
             3.450292912750046e+02, // 483
            -1.477102897016498e+02, // 484
            -2.231029696388105e+02, // 485
            -4.935501524198702e+02, // 486
             1.832301014142367e+02, // 487
            -1.772541602223043e+02, // 488
            -4.012889678250340e+02, // 489
             1.479161405301458e+02, // 490
            -9.007863716515587e+01, // 491
            -5.598008489180482e+01, // 492
             1.219460029601325e+02, // 493
             1.427303287943852e+02, // 494
             3.740721086915081e+01, // 495
             8.175052987268396e+00, // 496
            -4.313194989510110e+02, // 497
            -4.921259469845195e+01, // 498
            -4.194026118518815e+02, // 499
             1.121031759717045e+01, // 500
            -6.988222024909649e+01, // 501
            -8.079300846087519e+01, // 502
             3.854137530599072e+01, // 503
            -3.594784732345411e+02, // 504
            -7.562047371154558e+00, // 505
            -8.949004126228670e+01, // 506
             2.087224658981854e+02, // 507
             1.961903474845660e+02, // 508
             4.118844009883374e+02, // 509
             3.210783997284180e+02, // 510
            -1.576646226126954e+02, // 511
            -8.215490947445969e+01, // 512
             2.347002810797825e+03, // 513
            -8.645520419427932e+01, // 514
             7.335020285074772e+01, // 515
            -1.892953683148289e+02, // 516
            -5.320342204263265e+01, // 517
             3.105521790340477e+01, // 518
            -8.473368999943887e+01, // 519
            -9.512539573009764e+00, // 520
             6.623628081849788e+00, // 521
             2.123665777568867e+02, // 522
            -4.351860535161489e+02, // 523
            -1.306594155644572e+02, // 524
             6.802438674762603e+02, // 525
            -3.581321155386343e+02, // 526
             1.051328103422728e+01, // 527
             5.005950798770480e+02, // 528
             2.319375991038233e+01, // 529
            -1.885205251661322e+02, // 530
             8.280755682858664e+01, // 531
             2.750770737274227e+01, // 532
             6.206759331860354e+01, // 533
             1.265298569908124e+01, // 534
             2.754463246269152e+02, // 535
            -1.802179438556838e+02, // 536
            -4.118206358895288e+02, // 537
            -9.645938954456209e+01, // 538
            -6.503562582437914e+00, // 539
            -1.777028470849735e+02, // 540
             1.112906385802764e+03, // 541
            -3.430269793566110e+01, // 542
            -2.965664479942500e+02, // 543
             2.495952907945157e+02, // 544
            -4.666847731230804e+02, // 545
            -8.921703541212538e+01, // 546
            -1.892438436519459e+02, // 547
             2.547081301241784e+02, // 548
            -4.542957461451904e+02, // 549
            -1.487368691761157e+02, // 550
            -1.992374267208984e+01, // 551
            -1.053898302059601e+02, // 552
             1.160304626792734e+03, // 553
            -8.957289168159312e+01, // 554
             3.835727272429381e+01, // 555
            -4.063838032037449e+02, // 556
             1.288535631831046e+02, // 557
            -1.057706178752363e+02, // 558
            -1.275947744121229e+01, // 559
             8.074222357108893e+02, // 560
             1.264799162699968e+02, // 561
            -2.658004008760120e+02, // 562
             1.781276052937675e+01, // 563
             8.487433319170617e+01, // 564
             7.670033411130846e+02, // 565
             3.391407476853441e+01, // 566
            -1.810342646394670e+02, // 567
            -1.079194079314758e+03, // 568
            -2.033868472397986e+02, // 569
            -4.468579656834718e+00, // 570
            -3.794209294494414e+02, // 571
            -7.526366309201002e+01, // 572
            -3.881578127626551e+02, // 573
            -1.788185190422488e+02, // 574
            -1.133322737988709e+03, // 575
            -1.230526361921505e+02, // 576
             1.484639688892957e+01, // 577
             1.206025046700462e+03, // 578
             1.233573494526460e+02, // 579
             3.039435523064803e+02, // 580
            -3.362647921870195e+01, // 581
            -1.838013806047570e+02, // 582
            -3.554198169614856e+00, // 583
            -5.219101108746642e+00, // 584
            -4.061464561132885e+01, // 585
            -1.956209341127774e+02, // 586
             6.389358002965257e+01, // 587
             7.474118917621988e+01, // 588
            -7.913866198536626e+02, // 589
             5.331820560138901e+01, // 590
             2.201294468324216e+01, // 591
             1.275238057100782e+03, // 592
            -3.912812765263664e+02, // 593
            -1.114547092874137e+02, // 594
             1.650300325250602e+03, // 595
             6.977959010451651e+02, // 596
            -4.549587921851910e+01, // 597
            -6.314694527744521e+01, // 598
             1.379691245436211e+01, // 599
             1.832069822340954e+02, // 600
             2.111543993532108e+01, // 601
            -2.563069329520409e+02, // 602
             6.247791284324921e+01, // 603
             3.662363232477056e+01, // 604
             1.656608783929938e+02, // 605
            -2.716938084726663e+02, // 606
             7.967119392800126e+02, // 607
            -1.200880673349913e+01, // 608
            -4.373305756875041e+02, // 609
             5.982481143798935e+01, // 610
             1.856258096728190e+02, // 611
             2.691802880827008e+02, // 612
             1.604135679981068e+02, // 613
             9.752701854996596e+01, // 614
             3.354604242070230e+02, // 615
             1.114506851258951e+02, // 616
             3.375068511141168e+02, // 617
             2.611052664795841e+01, // 618
             8.283626111308099e+01, // 619
            -6.733159001379856e+01, // 620
            -4.171983410417060e+01, // 621
             4.486423211819544e+01, // 622
            -3.253670638363687e+01, // 623
            -5.617296538028971e+02, // 624
            -2.925460168755557e+01, // 625
            -1.412602544495730e+02, // 626
            -7.369978450648075e+01, // 627
            -5.856945234482857e+01, // 628
            -3.954386139350325e+01, // 629
            -2.361483637806458e+02, // 630
            -6.044460698097691e+02, // 631
             5.077553699532179e+01, // 632
            -1.679232874311064e+01, // 633
             4.438116033015167e+02, // 634
            -4.101929110190837e+02, // 635
            -6.460570159450596e+01, // 636
             1.334228742260379e+02, // 637
             2.024905259118586e+02, // 638
             9.190092310243493e+01, // 639
            -7.282643614595369e+01, // 640
             1.570579942451307e+02, // 641
             4.798074297810102e+01, // 642
             1.050321989562962e+02, // 643
             2.002032077708430e+02, // 644
            -3.059205892484620e+02, // 645
            -5.643038341757948e+01, // 646
            -1.649039798064917e+02, // 647
            -4.090755089720986e+02, // 648
             2.030549304567781e+02, // 649
             4.389679703734247e+02, // 650
            -3.112611351621365e+02, // 651
            -3.662832528399508e+02, // 652
             8.864212288407316e+00, // 653
             5.813836146238344e+01, // 654
             8.852259586356317e+01, // 655
             4.827124283639018e+02, // 656
             4.619458168030886e+02, // 657
             1.929628144681791e+02, // 658
             3.712129867167126e+02, // 659
             1.267777015112296e+02, // 660
             9.866193985205699e+01, // 661
             1.338037479990403e+02, // 662
             1.557190916178649e+03, // 663
             3.864115169177811e+01, // 664
            -3.805471721826646e+01, // 665
            -4.829740147461736e-01, // 666
            -2.887101722733218e+01, // 667
            -1.652264178737043e+02, // 668
             2.172491311666923e+01, // 669
             1.236189954526309e+01, // 670
             1.781531306075171e+01, // 671
             5.515873225462437e+02, // 672
             1.288114729269714e+02, // 673
             1.441706820509262e+02, // 674
             4.332217050764930e+02, // 675
             1.724248601220755e+02, // 676
            -1.063415841197021e+02, // 677
             2.850769359065193e+02, // 678
            -2.450269948954093e+02, // 679
            -2.092568463267365e+02, // 680
             7.155857850981239e+01, // 681
            -1.130921428101465e+02, // 682
            -2.632327305382817e+02, // 683
             2.483087816076419e+02, // 684
            -9.982349915544862e+01, // 685
            -4.127455052677964e+02, // 686
            -1.120693644247930e+03, // 687
            -1.231048098907719e+02, // 688
             4.181112269550624e+02, // 689
             2.811645876469682e+02, // 690
            -2.396201816536463e+02, // 691
             3.180852331177986e+02, // 692
            -1.163574230344254e+02, // 693
             1.713809644035225e+01, // 694
            -2.534471014362480e+02, // 695
             3.486948258622443e+02, // 696
            -1.036653355538750e+02, // 697
             1.659902733859635e+02, // 698
             7.345795225975725e+01, // 699
            -2.103551672493075e+02, // 700
            -2.445050276505723e+01, // 701
             3.552140665865240e+01, // 702
             9.378129522373451e+00, // 703
             3.966844748442816e+02, // 704
            -3.274979023676927e+02, // 705
            -6.143488520615251e+02, // 706
             5.759778573132618e+02, // 707
            -3.952509880515114e+02, // 708
             3.291044529781468e+01, // 709
             1.874402185890499e+02, // 710
             4.030091735027901e+01, // 711
             2.316669623043940e+02, // 712
             1.075178980830462e+02, // 713
             2.586170629569116e+01, // 714
            -5.236376915360977e+02, // 715
            -4.051177933738368e+02, // 716
            -2.004270564000975e+01, // 717
             4.516618678372123e+02, // 718
             7.307169233765651e+00, // 719
            -1.032721448235461e+02, // 720
            -1.011074496765000e+02, // 721
            -5.379206506165442e+01, // 722
            -1.968396691038704e+02, // 723
             4.281035283496328e+02, // 724
             1.233592590413830e+02, // 725
             1.902611349924545e+02, // 726
            -1.469806179325974e+02, // 727
            -1.435932690004041e+02, // 728
            -3.044935958214342e+01, // 729
            -1.104136505536971e+02, // 730
            -5.258224687274492e+01, // 731
            -5.194552572108118e+01, // 732
             1.743377240424935e+02, // 733
             1.503259190519366e+02, // 734
             3.100960700795424e+02, // 735
            -2.644494921664600e+02, // 736
            -3.105352292182309e+02, // 737
            -4.703868859772383e+02, // 738
            -3.635673571927065e+02, // 739
            -1.385472070554738e+02, // 740
            -9.199432002473698e+02, // 741
             5.139205496735632e+02, // 742
            -5.245700219091066e+01, // 743
             4.041549190715359e+02, // 744
             9.868986876253248e+01, // 745
            -5.161781263006180e+01, // 746
             2.437400364004940e+01, // 747
             1.333316988155024e+02, // 748
            -2.790134900665310e+02, // 749
             1.320893428005739e+02, // 750
            -3.219325917782162e+01, // 751
            -3.670912509639364e+00, // 752
            -4.912948355688366e+02, // 753
             3.607527996725446e+01, // 754
             5.232610080464011e+01, // 755
            -8.915468563830603e+02, // 756
            -7.047858974796257e+01, // 757
             9.236917927058384e+00, // 758
             1.736805092476779e+02, // 759
             3.659064767792790e+02, // 760
            -3.388500850512855e+02, // 761
             1.063906134769798e+01, // 762
             6.419244056878085e+01, // 763
             3.206655545924340e+02, // 764
             5.676619462456591e+01, // 765
            -1.646032009812320e+02, // 766
             4.729882697361677e+02, // 767
             3.221015715456262e+01, // 768
             1.603842375846092e+01, // 769
            -2.030826540391002e+02, // 770
             1.297850834346642e+02, // 771
            -1.378900036291117e+01, // 772
            -8.529867169638574e+01, // 773
             2.987123901646479e+02, // 774
             5.664034664811640e+01, // 775
            -1.400656364135722e+02, // 776
             1.013439515186532e+02, // 777
            -1.354672465187006e+02, // 778
             8.210650717795104e+01, // 779
             5.635413992251425e+00, // 780
            -5.474826466692876e+01, // 781
            -3.314840879655089e+02, // 782
             2.221727182166514e+01, // 783
             4.673013723651877e+02, // 784
            -3.176097225514087e+00, // 785
            -4.225368927403968e+02, // 786
            -9.613845255840340e+00, // 787
             2.632051006557461e+00, // 788
            -1.078948396061265e+01, // 789
             7.387635968524795e+02, // 790
             3.949296331332389e+02, // 791
            -4.015535511508386e+02, // 792
             5.984028040798427e+01, // 793
             5.751619210703159e+02, // 794
            -2.515696227173078e+02, // 795
             8.146883998609070e+02, // 796
             3.596733769927808e+01, // 797
            -1.145461025507307e+02, // 798
            -7.498761395687472e+01, // 799
            -8.616733881294768e+01, // 800
            -1.462640580604035e+02, // 801
             1.517879346376306e+02, // 802
            -3.953386310137692e+02, // 803
            -4.044229274235287e+02, // 804
             1.005018187881024e+02, // 805
             1.531859133368418e+02, // 806
             1.540623374559069e+02, // 807
             2.980393063934233e+02, // 808
             3.976611154752503e+02, // 809
            -3.216588659283941e+02, // 810
             2.551399892798593e+02, // 811
            -5.164590244371835e+01, // 812
             6.102094712684084e+02, // 813
            -2.004050203116384e+02, // 814
             1.839138048014998e+01, // 815
             1.171579878398037e+02, // 816
             3.683923288692070e+02, // 817
             2.963196163682567e+02, // 818
             2.252761176929879e+02, // 819
            -1.865171074294670e+02, // 820
             9.873554833927690e+01, // 821
            -6.657674626621203e+01, // 822
            -1.276187665808111e+03, // 823
             1.711069402794812e+02, // 824
            -5.112611139853796e+01, // 825
             1.576899258151396e+02, // 826
             1.288957623784728e+02, // 827
            -7.286866361307780e+01, // 828
             9.531839357286363e+01, // 829
             5.823272851147167e+01, // 830
            -6.852517076380069e+01, // 831
             1.682889788274400e+02, // 832
             2.453808383117731e+02, // 833
             5.286185510160091e+02, // 834
            -1.866304927766899e+02, // 835
            -6.939710925232807e+02, // 836
            -1.591325664726189e+02, // 837
            -2.237860619174344e+02, // 838
            -8.412189344028803e+01, // 839
             8.210688363121324e+01, // 840
            -7.200940209539289e+01, // 841
            -3.462959491217578e+01, // 842
             4.841052506831696e+01, // 843
            -2.162931043681739e+02, // 844
             2.039016794846660e+02, // 845
            -6.958229941677638e+01, // 846
             2.539462074523823e+02, // 847
             2.485156851182800e+02, // 848
             2.353571084821831e+02, // 849
             4.664810284050848e+02, // 850
             1.008260299957912e+02, // 851
             1.616405994735688e+02, // 852
             2.388623259770721e+02, // 853
             3.944234409149063e-01, // 854
            -2.946847895832097e+02, // 855
             4.780344312663015e+00, // 856
             2.273199430259529e+00, // 857
            -1.108448061210787e+00, // 858
             9.313296001999973e+01, // 859
             1.231770547094151e+02, // 860
            -1.531931680302173e+03, // 861
             5.700689964127106e+01, // 862
             3.877690707400531e+00, // 863
            -1.077122998485957e+02, // 864
            -1.107772188228484e+00, // 865
            -3.443108558169489e+02, // 866
            -7.870861310222583e+01, // 867
             9.074220901639359e+00, // 868
             1.114457838980339e+03, // 869
             9.123406461437517e+01, // 870
             2.153177769025517e+02, // 871
             3.342012093256023e+02, // 872
            -4.787275873152799e+01, // 873
            -1.475279339145275e+01, // 874
            -4.203905034777681e+01, // 875
             3.883932201717512e+02, // 876
             3.489669740874699e+02, // 877
            -2.531841117562288e+02, // 878
            -1.855118190474674e+02, // 879
            -3.307786365364054e+02, // 880
            -1.106194919115090e+02, // 881
             1.777518559174481e+03, // 882
            -4.972848247608881e+02, // 883
             1.357619960453761e+02, // 884
             1.062585244888202e+02, // 885
            -3.650068388060912e+01, // 886
            -8.476238125303659e+00, // 887
             2.886181418009476e+02, // 888
             1.641863452191379e+02, // 889
             4.696036685645904e+02, // 890
            -9.602537030149578e+02, // 891
             4.577820458264708e+01, // 892
             9.781783762569289e+01, // 893
             9.351924224495039e+01, // 894
            -3.577913649189040e+01, // 895
            -8.737875689920202e+01, // 896
             1.802623104734593e+02, // 897
            -2.625692413134458e+02, // 898
            -3.009189005234051e+02, // 899
            -7.739993064940172e+01, // 900
            -5.645466076680990e+02, // 901
            -6.306804425639807e+01, // 902
             3.564427579460522e+01, // 903
             1.947424332266025e+01, // 904
             2.532252368168809e+02, // 905
             1.156593143283131e+02, // 906
            -1.306261801105631e+02, // 907
            -2.402480746882846e+02, // 908
             8.679408012732006e+00, // 909
            -3.389826115829567e+02, // 910
            -1.300196962186550e+02, // 911
             6.580966547538081e+02, // 912
            -3.802159546600888e+02, // 913
            -9.492151900861641e+02, // 914
            -6.334575152173365e+01, // 915
             4.798880512491099e+02, // 916
             8.206568849915682e+01, // 917
            -1.029372822992610e+02, // 918
            -4.478916782952018e+01, // 919
             1.973317609807859e+02, // 920
             1.603018342145945e+02, // 921
             8.519922242963290e+01, // 922
             7.382794229700477e+01, // 923
             3.759697643734751e+01, // 924
            -9.046464319648169e+01, // 925
            -4.626989516512992e+02, // 926
            -6.785717364568802e+01, // 927
            -6.956443828251182e+01, // 928
             1.185874318350991e+03, // 929
             8.921827331521649e+01, // 930
             1.353340109883621e+02, // 931
            -1.221142709054072e+01, // 932
             6.813011706521458e+01, // 933
             8.172807205749248e+00, // 934
            -9.879330132637913e+00, // 935
             8.556390808283011e+01, // 936
            -1.635470795846418e+02, // 937
            -2.148284913052321e+02, // 938
            -9.381990778827760e+01, // 939
             7.038247318611488e+02, // 940
             8.731413012615278e+01, // 941
             1.146136241295501e+03, // 942
             9.504119569231752e+02, // 943
             1.648709932269032e+02, // 944
            -1.072435290506244e+02, // 945
            -4.048489741269388e+01, // 946
             1.533680001307244e+02, // 947
             3.222719297555652e+01, // 948
            -1.802675312507671e+02, // 949
            -1.246282382344557e+03, // 950
             1.650865186175646e+02, // 951
             1.903581209822162e+02, // 952
            -1.913140774016618e+02, // 953
             2.774960664065784e+02, // 954
             1.822237849366150e+02, // 955
             1.292023396196036e+03, // 956
            -5.536061759186285e+01, // 957
            -1.142501681083273e+02, // 958
             2.904676115163516e+01, // 959
            -1.464576115367369e+02, // 960
            -5.210715592836026e+02, // 961
             2.699833856847149e+02, // 962
            -8.491447345627395e+01, // 963
             1.382527696267273e+02, // 964
            -3.285564962634776e+02, // 965
            -7.510956916964179e+01, // 966
            -4.713010582026145e+02, // 967
             6.780933027324504e+01, // 968
             2.720767491844226e+02, // 969
             5.723523069983577e+01, // 970
            -4.224040860142767e+02, // 971
             2.650416057067919e+02, // 972
             2.409961039919516e+02, // 973
            -6.570843750352574e+02, // 974
             2.609841926317739e+02, // 975
             1.055204369844960e+03, // 976
            -5.159350387474713e+01, // 977
            -1.530668250587745e+00, // 978
             1.885723905681049e+01, // 979
            -4.701690561855230e+02, // 980
             1.757628304607711e+02, // 981
            -1.586198758091367e+01, // 982
             1.032270436287714e+02, // 983
             1.113613271670191e+01, // 984
             1.748278468405802e+02, // 985
            -8.723277124195070e+01, // 986
            -9.319892277420142e+02, // 987
            -2.084300462028226e+02, // 988
             1.077801590863523e+02, // 989
            -1.012239171586110e+02, // 990
             3.873634121913904e+01, // 991
            -1.274399725277624e+02, // 992
            -2.149974944502378e+02, // 993
             1.814694182418382e+02, // 994
            -8.286333756443611e+01, // 995
            -4.507073299518563e+02, // 996
             4.232445197737276e+02, // 997
            -1.599852541796218e+02, // 998
            -6.260442109372612e+01, // 999
            -1.367865138391645e+02, // 1000
            -1.338486288685977e+02, // 1001
             2.429534462085782e+02, // 1002
            -1.382608236368788e+01, // 1003
            -7.656230245736148e+02, // 1004
             4.230189236019335e+01, // 1005
             5.897215913845394e+02, // 1006
            -4.751669742754555e+02, // 1007
            -1.722016681938618e+01, // 1008
            -3.985982061475494e+02, // 1009
             5.074544892835501e+02, // 1010
            -7.052538231541553e+01, // 1011
             2.404975122995906e+02, // 1012
             2.571441515063498e+02, // 1013
            -1.226362647404602e+02, // 1014
             1.305493299686015e+02, // 1015
            -4.319684443223977e+01, // 1016
             5.118970183315960e+02, // 1017
             2.320115829922712e+02, // 1018
             2.688012579161710e+02, // 1019
             3.622680334381206e+01, // 1020
             1.999799017958587e+02, // 1021
            -1.699397040764122e+02, // 1022
             1.510510847180941e+03, // 1023
            -6.637199373995361e+02, // 1024
            -4.121543303973542e+01, // 1025
             1.959093581198152e+02, // 1026
            -4.354565837625563e+02, // 1027
            -2.208379128145359e+02, // 1028
             6.249138391155310e+02, // 1029
             1.324391951978485e+02, // 1030
             2.006594920247838e+01, // 1031
             6.801611117883749e+01, // 1032
            -7.429292046276146e+01, // 1033
             3.633924420532022e+02, // 1034
             2.766751620228330e+02, // 1035
            -1.963729511842630e+02, // 1036
             4.640879445159167e-01, // 1037
            -6.048490191795554e+01, // 1038
            -8.468808171025115e+01, // 1039
            -1.037380150239467e+03, // 1040
             3.150752088215344e+01, // 1041
             1.303206627780425e+02, // 1042
             1.506413285072398e+02, // 1043
             2.166077247219577e+03, // 1044
            -9.337291657392463e+00, // 1045
            -8.162992326580132e+01, // 1046
            -3.450503547504892e+02, // 1047
            -2.042202723473569e+02, // 1048
            -3.973806419973011e+02, // 1049
             2.911953917605433e+02, // 1050
             6.692571388225156e+01, // 1051
            -3.251587035541633e+00, // 1052
            -7.023256217209847e+01, // 1053
             5.542627864241464e+02, // 1054
             1.008321500434730e+02, // 1055
             1.148388271575859e+02, // 1056
            -6.754602541073838e+02, // 1057
             1.360419351988591e+01, // 1058
             1.865686823061737e+02, // 1059
            -5.825016781837650e+02, // 1060
             5.210167793647350e+02, // 1061
             2.750741944359781e+02, // 1062
             9.232419585112664e+00, // 1063
             4.699277497224106e+01, // 1064
            -6.550670322436322e+02, // 1065
            -4.062189249840794e+02, // 1066
             4.593353510900491e+01, // 1067
             2.666056483186143e+01, // 1068
             2.453221947535653e+02, // 1069
            -8.295164821701777e+02, // 1070
            -9.413451760067177e+02, // 1071
            -2.734027374388890e+02, // 1072
            -1.587684404470188e+02, // 1073
            -7.690868503844097e+02, // 1074
             2.833774849763970e+02, // 1075
            -1.195791256634255e+02, // 1076
            -3.699818147855193e+01, // 1077
             1.880081181167024e+02, // 1078
            -9.806479056017774e+02, // 1079
            -3.770593641281488e+02, // 1080
             8.786730373464339e+01, // 1081
            -2.078851074217004e+01, // 1082
            -6.016215138026886e+02, // 1083
            -2.078372443459353e+01, // 1084
             1.163172001238746e+02, // 1085
             1.347127051294485e+02, // 1086
            -7.620602678576655e+01, // 1087
             2.571065686119674e+01, // 1088
             8.103183996840981e+01, // 1089
             3.814975074230773e+02, // 1090
            -1.473989604419955e+02, // 1091
            -3.133116987664423e+02, // 1092
             2.651671123146127e+02, // 1093
             6.189832639687770e+02, // 1094
             1.138545249386284e+03, // 1095
             4.990960860220562e+02, // 1096
             7.943188948178434e+01, // 1097
             3.823188485152091e+02, // 1098
            -1.374914292043108e+01, // 1099
            -5.600028629135035e+02, // 1100
             1.368375800217543e+02, // 1101
             1.251721406125636e+01, // 1102
             9.789935717716956e+01, // 1103
            -2.146847633693172e+01, // 1104
            -1.856581378225510e+02, // 1105
            -6.300965505080023e+01, // 1106
             7.937021652939632e+01, // 1107
            -3.424268164774675e+02, // 1108
             2.015011770739280e+02, // 1109
            -3.117392161180177e+03, // 1110
             6.930127607096601e+01, // 1111
             6.223956875387938e+01, // 1112
            -6.432168976914029e+02, // 1113
             1.926766066266714e+02}; // 1114
    m_k_x_inter_A_A_0 =  5.768455373761808e-01; // A^(-1))
    m_k_x_intra_A_B_1 =  6.322584059564942e-01; // A^(-1))
    m_k_x_inter_A_B_0 =  7.479518534469181e-01; // A^(-1))
    m_k_x_intra_B_B_1 =  5.361997414884796e-01; // A^(-1))
    m_k_x_inter_B_B_0 =  3.817318079032517e-01; // A^(-1))
    m_ri =  5.000000000000000e+00; // A
    m_ro =  6.500000000000000e+00; // A

    } // end if mon1 == "nh3" and mon2 == "nh3"

    // =====>> END SECTION CONSTRUCTOR <<=====
}

//----------------------------------------------------------------------------//

double mbnrg_A1B3_A1B3_deg4_v1::f_switch(const double r, double& g) {
    if (r > m_ro) {
        g = 0.0;
        return 0.0;
    } else if (r > m_ri) {
        const double t1 = M_PI / (m_ro - m_ri);
        const double x = (r - m_ri) * t1;
        g = -std::sin(x) * t1 / 2.0;
        return (1.0 + std::cos(x)) / 2.0;
    } else {
        g = 0.0;
        return 1.0;
    }
}

//----------------------------------------------------------------------------//

double mbnrg_A1B3_A1B3_deg4_v1::eval(const double* xyz1, const double* xyz2, const size_t n) {
    std::vector<double> energies(n, 0.0);
    std::vector<double> energies_sw(n, 0.0);

    std::vector<double> xyz(24);
    double sw = 0.0;
    polynomial my_poly;

    for (size_t j = 0; j < n; j++) {
        const double* mon1 = xyz1 + 12 * j;
        const double* mon2 = xyz2 + 12 * j;

        const double d12[3] = {mon1[0] - mon2[0], mon1[1] - mon2[1], mon1[2] - mon2[2]};

        const double d12rsq = d12[0] * d12[0] + d12[1] * d12[1] + d12[2] * d12[2];
        const double d12r = std::sqrt(d12rsq);

        if (true && d12r > m_ro) {
            continue;
        }

        std::copy(mon1, mon1 + 12, xyz.begin() + 0);

        std::copy(mon2, mon2 + 12, xyz.begin() + 12);

        const double* coords_A_1_a = xyz.data() + 0;

        const double* coords_B_1_a = xyz.data() + 3;

        const double* coords_B_2_a = xyz.data() + 6;

        const double* coords_B_3_a = xyz.data() + 9;

        const double* coords_A_2_b = xyz.data() + 12;

        const double* coords_B_4_b = xyz.data() + 15;

        const double* coords_B_5_b = xyz.data() + 18;

        const double* coords_B_6_b = xyz.data() + 21;

        double w12 = -9.721486914088159e-02;  // from MBpol
        double w13 = -9.721486914088159e-02;
        double wcross = 9.859272078406150e-02;

        variable vs[28];

        double xs[28];

        xs[0] = vs[0].v_exp(m_k_x_inter_A_A_0, coords_A_1_a, coords_A_2_b);
        xs[1] = vs[1].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_1_a);
        xs[2] = vs[2].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_2_a);
        xs[3] = vs[3].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_3_a);
        xs[4] = vs[4].v_exp(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_4_b);
        xs[5] = vs[5].v_exp(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_5_b);
        xs[6] = vs[6].v_exp(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_6_b);
        xs[7] = vs[7].v_exp(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_1_a);
        xs[8] = vs[8].v_exp(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_2_a);
        xs[9] = vs[9].v_exp(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_3_a);
        xs[10] = vs[10].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_4_b);
        xs[11] = vs[11].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_5_b);
        xs[12] = vs[12].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_6_b);
        xs[13] = vs[13].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_2_a);
        xs[14] = vs[14].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_3_a);
        xs[15] = vs[15].v_exp(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_4_b);
        xs[16] = vs[16].v_exp(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_5_b);
        xs[17] = vs[17].v_exp(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_6_b);
        xs[18] = vs[18].v_exp(m_k_x_intra_B_B_1, coords_B_2_a, coords_B_3_a);
        xs[19] = vs[19].v_exp(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_4_b);
        xs[20] = vs[20].v_exp(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_5_b);
        xs[21] = vs[21].v_exp(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_6_b);
        xs[22] = vs[22].v_exp(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_4_b);
        xs[23] = vs[23].v_exp(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_5_b);
        xs[24] = vs[24].v_exp(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_6_b);
        xs[25] = vs[25].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_5_b);
        xs[26] = vs[26].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_6_b);
        xs[27] = vs[27].v_exp(m_k_x_intra_B_B_1, coords_B_5_b, coords_B_6_b);

        double gsw12 = 0.0;
        double sw12 = f_switch(d12r, gsw12);

        sw = sw12;

        energies[j] = my_poly.eval(xs, coefficients.data());
        energies_sw[j] = energies[j] * sw;
    }

    double energy = 0.0;
    for (size_t i = 0; i < n; i++) energy += energies_sw[i];

    return energy;
}

//----------------------------------------------------------------------------//

double mbnrg_A1B3_A1B3_deg4_v1::eval(const double* xyz1, const double* xyz2, double* grad1, double* grad2,
                                     const size_t n, std::vector<double>* virial) {
    std::vector<double> energies(n, 0.0);
    std::vector<double> energies_sw(n, 0.0);

    std::vector<double> xyz(24);
    double sw = 0.0;
    polynomial my_poly;

    for (size_t j = 0; j < n; j++) {
        const double* mon1 = xyz1 + 12 * j;
        const double* mon2 = xyz2 + 12 * j;

        const double d12[3] = {mon1[0] - mon2[0], mon1[1] - mon2[1], mon1[2] - mon2[2]};

        const double d12rsq = d12[0] * d12[0] + d12[1] * d12[1] + d12[2] * d12[2];
        const double d12r = std::sqrt(d12rsq);

        if (true && d12r > m_ro) {
            continue;
        }

        std::vector<double> gradients(24, 0.0);

        std::copy(mon1, mon1 + 12, xyz.begin() + 0);

        std::copy(mon2, mon2 + 12, xyz.begin() + 12);
        const double* coords_A_1_a = xyz.data() + 0;

        const double* coords_B_1_a = xyz.data() + 3;

        const double* coords_B_2_a = xyz.data() + 6;

        const double* coords_B_3_a = xyz.data() + 9;

        const double* coords_A_2_b = xyz.data() + 12;

        const double* coords_B_4_b = xyz.data() + 15;

        const double* coords_B_5_b = xyz.data() + 18;

        const double* coords_B_6_b = xyz.data() + 21;

        double* coords_A_1_a_g = gradients.data() + 0;

        double* coords_B_1_a_g = gradients.data() + 3;

        double* coords_B_2_a_g = gradients.data() + 6;

        double* coords_B_3_a_g = gradients.data() + 9;

        double* coords_A_2_b_g = gradients.data() + 12;

        double* coords_B_4_b_g = gradients.data() + 15;

        double* coords_B_5_b_g = gradients.data() + 18;

        double* coords_B_6_b_g = gradients.data() + 21;

        double w12 = -9.721486914088159e-02;  // from MBpol
        double w13 = -9.721486914088159e-02;
        double wcross = 9.859272078406150e-02;

        variable vs[28];

        double xs[28];

        double gxs[28];

        xs[0] = vs[0].v_exp(m_k_x_inter_A_A_0, coords_A_1_a, coords_A_2_b);
        xs[1] = vs[1].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_1_a);
        xs[2] = vs[2].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_2_a);
        xs[3] = vs[3].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_3_a);
        xs[4] = vs[4].v_exp(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_4_b);
        xs[5] = vs[5].v_exp(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_5_b);
        xs[6] = vs[6].v_exp(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_6_b);
        xs[7] = vs[7].v_exp(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_1_a);
        xs[8] = vs[8].v_exp(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_2_a);
        xs[9] = vs[9].v_exp(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_3_a);
        xs[10] = vs[10].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_4_b);
        xs[11] = vs[11].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_5_b);
        xs[12] = vs[12].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_6_b);
        xs[13] = vs[13].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_2_a);
        xs[14] = vs[14].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_3_a);
        xs[15] = vs[15].v_exp(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_4_b);
        xs[16] = vs[16].v_exp(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_5_b);
        xs[17] = vs[17].v_exp(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_6_b);
        xs[18] = vs[18].v_exp(m_k_x_intra_B_B_1, coords_B_2_a, coords_B_3_a);
        xs[19] = vs[19].v_exp(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_4_b);
        xs[20] = vs[20].v_exp(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_5_b);
        xs[21] = vs[21].v_exp(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_6_b);
        xs[22] = vs[22].v_exp(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_4_b);
        xs[23] = vs[23].v_exp(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_5_b);
        xs[24] = vs[24].v_exp(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_6_b);
        xs[25] = vs[25].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_5_b);
        xs[26] = vs[26].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_6_b);
        xs[27] = vs[27].v_exp(m_k_x_intra_B_B_1, coords_B_5_b, coords_B_6_b);

        double gsw12 = 0.0;
        double sw12 = f_switch(d12r, gsw12);

        sw = sw12;

        energies[j] = my_poly.eval(xs, coefficients.data(), gxs);
        energies_sw[j] = energies[j] * sw;

        for (size_t i = 0; i < 28; i++) {
            gxs[i] *= sw;
        }

        vs[0].grads(gxs[0], coords_A_1_a_g, coords_A_2_b_g, coords_A_1_a, coords_A_2_b);
        vs[1].grads(gxs[1], coords_A_1_a_g, coords_B_1_a_g, coords_A_1_a, coords_B_1_a);
        vs[2].grads(gxs[2], coords_A_1_a_g, coords_B_2_a_g, coords_A_1_a, coords_B_2_a);
        vs[3].grads(gxs[3], coords_A_1_a_g, coords_B_3_a_g, coords_A_1_a, coords_B_3_a);
        vs[4].grads(gxs[4], coords_A_1_a_g, coords_B_4_b_g, coords_A_1_a, coords_B_4_b);
        vs[5].grads(gxs[5], coords_A_1_a_g, coords_B_5_b_g, coords_A_1_a, coords_B_5_b);
        vs[6].grads(gxs[6], coords_A_1_a_g, coords_B_6_b_g, coords_A_1_a, coords_B_6_b);
        vs[7].grads(gxs[7], coords_A_2_b_g, coords_B_1_a_g, coords_A_2_b, coords_B_1_a);
        vs[8].grads(gxs[8], coords_A_2_b_g, coords_B_2_a_g, coords_A_2_b, coords_B_2_a);
        vs[9].grads(gxs[9], coords_A_2_b_g, coords_B_3_a_g, coords_A_2_b, coords_B_3_a);
        vs[10].grads(gxs[10], coords_A_2_b_g, coords_B_4_b_g, coords_A_2_b, coords_B_4_b);
        vs[11].grads(gxs[11], coords_A_2_b_g, coords_B_5_b_g, coords_A_2_b, coords_B_5_b);
        vs[12].grads(gxs[12], coords_A_2_b_g, coords_B_6_b_g, coords_A_2_b, coords_B_6_b);
        vs[13].grads(gxs[13], coords_B_1_a_g, coords_B_2_a_g, coords_B_1_a, coords_B_2_a);
        vs[14].grads(gxs[14], coords_B_1_a_g, coords_B_3_a_g, coords_B_1_a, coords_B_3_a);
        vs[15].grads(gxs[15], coords_B_1_a_g, coords_B_4_b_g, coords_B_1_a, coords_B_4_b);
        vs[16].grads(gxs[16], coords_B_1_a_g, coords_B_5_b_g, coords_B_1_a, coords_B_5_b);
        vs[17].grads(gxs[17], coords_B_1_a_g, coords_B_6_b_g, coords_B_1_a, coords_B_6_b);
        vs[18].grads(gxs[18], coords_B_2_a_g, coords_B_3_a_g, coords_B_2_a, coords_B_3_a);
        vs[19].grads(gxs[19], coords_B_2_a_g, coords_B_4_b_g, coords_B_2_a, coords_B_4_b);
        vs[20].grads(gxs[20], coords_B_2_a_g, coords_B_5_b_g, coords_B_2_a, coords_B_5_b);
        vs[21].grads(gxs[21], coords_B_2_a_g, coords_B_6_b_g, coords_B_2_a, coords_B_6_b);
        vs[22].grads(gxs[22], coords_B_3_a_g, coords_B_4_b_g, coords_B_3_a, coords_B_4_b);
        vs[23].grads(gxs[23], coords_B_3_a_g, coords_B_5_b_g, coords_B_3_a, coords_B_5_b);
        vs[24].grads(gxs[24], coords_B_3_a_g, coords_B_6_b_g, coords_B_3_a, coords_B_6_b);
        vs[25].grads(gxs[25], coords_B_4_b_g, coords_B_5_b_g, coords_B_4_b, coords_B_5_b);
        vs[26].grads(gxs[26], coords_B_4_b_g, coords_B_6_b_g, coords_B_4_b, coords_B_6_b);
        vs[27].grads(gxs[27], coords_B_5_b_g, coords_B_6_b_g, coords_B_5_b, coords_B_6_b);
        gsw12 *= (1.0) * energies[j] / d12r;

        for (size_t i = 0; i < 3; i++) {
            gradients[0 + i] += 0.0 + (gsw12 * d12[i]);
            gradients[12 + i] += 0.0 - (gsw12 * d12[i]);
        }

        for (size_t i = 0; i < 12; i++) {
            grad1[i + j * 12] += gradients[0 + i];
        }

        for (size_t i = 0; i < 12; i++) {
            grad2[i + j * 12] += gradients[12 + i];
        }

        if (virial != 0) {
            (*virial)[0] += -coords_A_1_a[0] * coords_A_1_a_g[0] - coords_B_1_a[0] * coords_B_1_a_g[0] -
                            coords_B_2_a[0] * coords_B_2_a_g[0] - coords_B_3_a[0] * coords_B_3_a_g[0] -
                            coords_A_2_b[0] * coords_A_2_b_g[0] - coords_B_4_b[0] * coords_B_4_b_g[0] -
                            coords_B_5_b[0] * coords_B_5_b_g[0] - coords_B_6_b[0] * coords_B_6_b_g[0];

            (*virial)[1] += -coords_A_1_a[0] * coords_A_1_a_g[1] - coords_B_1_a[0] * coords_B_1_a_g[1] -
                            coords_B_2_a[0] * coords_B_2_a_g[1] - coords_B_3_a[0] * coords_B_3_a_g[1] -
                            coords_A_2_b[0] * coords_A_2_b_g[1] - coords_B_4_b[0] * coords_B_4_b_g[1] -
                            coords_B_5_b[0] * coords_B_5_b_g[1] - coords_B_6_b[0] * coords_B_6_b_g[1];

            (*virial)[2] += -coords_A_1_a[0] * coords_A_1_a_g[2] - coords_B_1_a[0] * coords_B_1_a_g[2] -
                            coords_B_2_a[0] * coords_B_2_a_g[2] - coords_B_3_a[0] * coords_B_3_a_g[2] -
                            coords_A_2_b[0] * coords_A_2_b_g[2] - coords_B_4_b[0] * coords_B_4_b_g[2] -
                            coords_B_5_b[0] * coords_B_5_b_g[2] - coords_B_6_b[0] * coords_B_6_b_g[2];

            (*virial)[4] += -coords_A_1_a[1] * coords_A_1_a_g[1] - coords_B_1_a[1] * coords_B_1_a_g[1] -
                            coords_B_2_a[1] * coords_B_2_a_g[1] - coords_B_3_a[1] * coords_B_3_a_g[1] -
                            coords_A_2_b[1] * coords_A_2_b_g[1] - coords_B_4_b[1] * coords_B_4_b_g[1] -
                            coords_B_5_b[1] * coords_B_5_b_g[1] - coords_B_6_b[1] * coords_B_6_b_g[1];

            (*virial)[5] += -coords_A_1_a[1] * coords_A_1_a_g[2] - coords_B_1_a[1] * coords_B_1_a_g[2] -
                            coords_B_2_a[1] * coords_B_2_a_g[2] - coords_B_3_a[1] * coords_B_3_a_g[2] -
                            coords_A_2_b[1] * coords_A_2_b_g[2] - coords_B_4_b[1] * coords_B_4_b_g[2] -
                            coords_B_5_b[1] * coords_B_5_b_g[2] - coords_B_6_b[1] * coords_B_6_b_g[2];

            (*virial)[8] += -coords_A_1_a[2] * coords_A_1_a_g[2] - coords_B_1_a[2] * coords_B_1_a_g[2] -
                            coords_B_2_a[2] * coords_B_2_a_g[2] - coords_B_3_a[2] * coords_B_3_a_g[2] -
                            coords_A_2_b[2] * coords_A_2_b_g[2] - coords_B_4_b[2] * coords_B_4_b_g[2] -
                            coords_B_5_b[2] * coords_B_5_b_g[2] - coords_B_6_b[2] * coords_B_6_b_g[2];

            (*virial)[3] = (*virial)[1];
            (*virial)[6] = (*virial)[2];
            (*virial)[7] = (*virial)[5];
        }
    }

    double energy = 0.0;
    for (size_t i = 0; i < n; i++) energy += energies_sw[i];

    return energy;
}

//----------------------------------------------------------------------------//
}  // namespace mbnrg_A1B3_A1B3_deg4
